@buildings_t1 = 1
@buildings_t2 = 2
@buildings_t3 = 3
@buildings_t4 = 4

@tier_2_capital_defense_armies = 4
@tier_3_capital_defense_armies = 8
@tier_4_capital_defense_armies = 16

#############
# Capital buildings
#############
# Planetary Administration
# Planetary Administration
building_capital = {
	base_buildtime = @b2_time
	capital = yes
	can_build = no
	can_demolish = no
	can_be_ruined = no
	can_be_disabled = no
	position_priority = 0

	category = government

	potential = {
		exists = owner
		owner = {
			is_regular_empire = yes
			is_fallen_empire = no
		}
		NOR = {
			has_modifier = resort_colony
			has_modifier = slave_colony
			uses_habitat_capitals = yes
			is_planet_class = pc_cosmogenesis_world
		}
	}

	convert_to = {
		building_hive_capital
		building_machine_capital
		building_resort_capital
		building_slave_capital
		building_ancient_control_center
		building_ancient_palace
		building_capital_nanotech
	}

	allow = {
		OR = {
			PR_prmt_trgr_HC = { MORE = 10 }	# |PR转化|
			num_sapient_pops >= 10
		}
	}

	upgrades = {
		"building_major_capital"
	}

	prerequisites = {
		"tech_planetary_government"
	}

	show_tech_unlock_if = {
		is_regular_empire = yes
	}

	planet_modifier = {
		job_enforcer_add = 1
		planet_housing_add = 5
		planet_amenities_add = 5
		planet_max_buildings_add = @buildings_t2
		planet_max_branch_office_buildings_add = 1
		defense_armies_add = @tier_2_capital_defense_armies
	}

	inline_script = {
		script = buildings/on_all_capital_buildings
	}

	inline_script = {
		script = buildings/regular_empire_capital_jobs
		PRIMARY_JOB = 1
		SECONDARY_JOB = 1
		TERTIARY_JOB = 2
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner.federation
			owner.federation = { has_federation_perk = culture_workers_1 }
		}
		job_culture_worker_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_active_tradition = tr_domination_imperious_architecture
			}
		}
		modifier = {
			planet_housing_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_1 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.1
			planet_jobs_productive_produces_mult = 0.1
		}
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b2_minerals
		}
		upkeep = {
			energy = @b2_upkeep
		}
	}

	triggered_desc = {
		text = job_enforcer_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner.federation
			owner.federation = { has_federation_perk = culture_workers_1 }
		}
		text = job_culture_worker_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				is_pleasure_seeker = yes
			}
		}
		text = job_entertainer_effect_desc
	}

	triggered_desc = {
		trigger = {
			has_modifier = payback_unified_purpose
		}
		text = job_unifier_effect_desc
	}

	#莉莉修改
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_origin = origin_AL_Sierlint
			}
		}
		modifier = {
			job_AL_head_majyo_add = 1
		}
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_origin = origin_AL_Sierlint
			}
		}
		text = job_AL_head_majyo_effect_desc
	}
}

# Major Capital
building_major_capital = {
	base_buildtime = @b3_time
	capital = yes
	can_build = no
	can_demolish = no
	can_be_ruined = no
	can_be_disabled = no
	position_priority = 0

	category = government

	potential = {
		exists = owner
		owner = {
			is_regular_empire = yes
			is_fallen_empire = no
		}
		NOR = {
			has_modifier = resort_colony
			has_modifier = slave_colony
		}
	}

	allow = {
		OR = {
			PR_prmt_trgr_HC = { MORE = 25 }	# |PR转化|
			num_sapient_pops >= 25
		}
	}

	convert_to = {
		building_hive_major_capital
		building_machine_major_capital
		building_resort_major_capital
		building_slave_major_capital
		building_ancient_control_center
		building_ancient_palace
		building_major_capital_nanotech
	}

	prerequisites = {
		"tech_colonial_centralization"
	}

	show_tech_unlock_if = {
		is_regular_empire = yes
	}

	planet_modifier = {
		job_enforcer_add = 2
		planet_housing_add = 8
		planet_amenities_add = 8
		planet_max_buildings_add = @buildings_t3
		planet_max_branch_office_buildings_add = 2
		defense_armies_add = @tier_3_capital_defense_armies
	}

	inline_script = {
		script = buildings/on_all_capital_buildings
	}

	inline_script = {
		script = buildings/regular_empire_capital_jobs
		PRIMARY_JOB = 2
		SECONDARY_JOB = 1
		TERTIARY_JOB = 2
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_active_tradition = tr_domination_imperious_architecture
			}
		}
		modifier = {
			planet_housing_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_1 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.1
			planet_jobs_productive_produces_mult = 0.1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_2 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.1
			planet_jobs_productive_produces_mult = 0.1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner.federation
			owner.federation = { has_federation_perk = culture_workers_1 }
		}
		job_culture_worker_add = 1
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b3_minerals
		}
		upkeep = {
			energy = @b3_upkeep
		}
	}

	triggered_desc = {
		text = job_enforcer_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { has_valid_civic = civic_private_healthcare_corporate }
		}
		text = job_healthcare_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner.federation
			owner.federation = { has_federation_perk = culture_workers_1 }
		}
		text = job_culture_worker_effect_desc
	}

	triggered_desc = {
		trigger = {
			has_modifier = payback_unified_purpose
		}
		text = job_unifier_effect_desc
	}

	upgrades = {
		"building_system_capital"
	}
    #莉莉修改
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_origin = origin_AL_Sierlint
			}
		}
		modifier = {
			job_AL_head_majyo_add = 1
		}
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_origin = origin_AL_Sierlint
			}
		}
		text = job_AL_head_majyo_effect_desc
	}
}

building_system_capital = {
	base_buildtime = @b4_time
	capital = yes
	can_build = no
	can_demolish = no
	can_be_ruined = no
	can_be_disabled = no
	position_priority = 0

	category = government

	potential = {
		exists = owner
		owner = {
			is_regular_empire = yes
			is_fallen_empire = no
		}
		NOR = {
			has_modifier = resort_colony
			has_modifier = slave_colony
		}
	}

	convert_to = {
		building_hive_major_capital
		building_machine_major_capital
		building_major_capital
		building_resort_major_capital
		building_slave_major_capital
		building_ancient_control_center
		building_ancient_palace
		building_system_capital_nanotech
	}

	OR = {
		PR_prmt_trgr_HC = { MORE = 50 }	# |PR转化|
		num_sapient_pops >= 50
	}

	prerequisites = {
		"tech_galactic_administration"
	}

	show_tech_unlock_if = {
		is_regular_empire = yes
	}

	planet_modifier = {
		job_enforcer_add = 3
		planet_housing_add = 12
		planet_amenities_add = 12
		planet_max_buildings_add = @buildings_t4
		planet_max_branch_office_buildings_add = 4
		defense_armies_add = @tier_4_capital_defense_armies
	}

	inline_script = {
		script = buildings/on_all_capital_buildings
	}

	inline_script = {
		script = buildings/regular_empire_capital_jobs
		PRIMARY_JOB = 2
		SECONDARY_JOB = 2
		TERTIARY_JOB = 2
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_active_tradition = tr_domination_imperious_architecture
			}
		}
		modifier = {
			planet_housing_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_active_tradition = tr_domination_imperious_architecture
			}
		}
		modifier = {
			planet_housing_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_1 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.1
			planet_jobs_productive_produces_mult = 0.1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_2 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.1
			planet_jobs_productive_produces_mult = 0.1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_3 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.1
			planet_jobs_productive_produces_mult = 0.1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner.federation
			owner.federation = { has_federation_perk = culture_workers_1 }
		}
		job_culture_worker_add = 2
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b4_minerals
		}
		upkeep = {
			energy = @b4_upkeep
		}
	}

	triggered_desc = {
		text = job_enforcer_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner.federation
			owner.federation = { has_federation_perk = culture_workers_1 }
		}
		text = job_culture_worker_effect_desc
	}

	triggered_desc = {
		trigger = {
			has_modifier = payback_unified_purpose
		}
		text = job_unifier_effect_desc
	}

	upgrades = {
		building_imperial_capital
		building_ancient_palace
		azur_building_mind_capital
	}

	#莉莉修改
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_origin = origin_AL_Sierlint
			}
		}
		modifier = {
			job_AL_head_majyo_add = 2
		}
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_origin = origin_AL_Sierlint
			}
		}
		text = job_AL_head_majyo_effect_desc
	}
}

#############
# Habitat buildings
#############

# Habitat Administration
building_hab_capital = {
	capital = yes
	can_build = no
	can_demolish = no
	can_be_ruined = no
	can_be_disabled = no
	position_priority = 0

	icon = building_capital

	category = government

	potential = {
		uses_habitat_capitals = yes
		exists = owner
		owner = { is_fallen_empire = no }
	}

	convert_to = {
		building_hab_fe_capital
	}

	prerequisites = {
		"tech_habitat_1"
	}

	resources = {
		category = planet_buildings_hab_capital
		upkeep = {
			energy = 3
			alloys = 5
		}
		upkeep = {
			trigger = { owner = { has_active_tradition = tr_expansion_adopt } }
			alloys = -1
		}
	}

	planet_modifier = {
		planet_housing_add = 3
		planet_amenities_add = 3
		planet_max_buildings_add = @buildings_t1
		defense_armies_add = @tier_2_capital_defense_armies
	}

	inline_script = {
		script = buildings/on_all_capital_buildings
	}

	inline_script = {
		script = buildings/on_all_habitat_capital_buildings
	}

	triggered_planet_modifier = {
		modifier = { planet_stability_add = 1 }
		mult = modifier:habitat_stability_add
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_active_tradition = tr_domination_imperious_architecture
			}
		}
		modifier = {
			planet_housing_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_active_tradition = tr_synthetics_prefabricated_components }
		}
		job_roboticist_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_valid_civic = civic_private_healthcare_corporate }
		}
		job_healthcare_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_individual_machine = yes
			}
		}
		job_roboticist_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_pleasure_seeker = yes
			}
		}
		job_entertainer_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				NOT = {
					has_authority = auth_corporate
				}
				is_regular_empire = yes
			}
		}
		job_politician_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_authority = auth_corporate
				is_worker_coop_empire = no
			}
		}
		modifier = {
			job_executive_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_authority = auth_corporate
				is_worker_coop_empire = yes
			}
		}
		modifier = {
			job_steward_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_civic = civic_dystopian_society }
		}
		modifier = {
			job_enforcer_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_hive_empire = yes }
		}
		job_synapse_drone_add = 2
		planet_amenities_add = 3
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_machine_empire = yes }
		}
		job_evaluator_add = 1
		job_replicator_add = 1
		job_maintenance_drone_add = 2
		planet_amenities_add = 3
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				is_regular_empire = yes
				has_valid_civic = civic_dystopian_society
			}
		}
		text = job_enforcer_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				NOT = {
					has_authority = auth_corporate
				}
				is_regular_empire = yes
			}
		}
		text = job_politician_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				OR = {
					is_individual_machine = yes
					AND = {
						is_regular_empire = yes
						has_active_tradition = tr_synthetics_prefabricated_components
					}
				}
			}
		}
		text = job_roboticist_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				is_megacorp = yes
				is_worker_coop_empire = no
			}
		}
		text = job_executive_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				is_megacorp = yes
				is_worker_coop_empire = yes
			}
		}
		text = job_steward_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { has_valid_civic = civic_private_healthcare_corporate }
		}
		text = job_healthcare_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				is_pleasure_seeker = yes
			}
		}
		text = job_entertainer_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_machine_empire = yes }
		}
		text = job_evaluator_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_machine_empire = yes }
		}
		text = job_replicator_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_machine_empire = yes }
		}
		text = job_maintenance_drone_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_hive_empire = yes }
		}
		text = job_synapse_drone_effect_desc
	}

	upgrades = {
		"building_hab_major_capital"
	}
	# 莉莉修改
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_origin = origin_AL_Sierlint
			}
		}
		modifier = {
			job_AL_head_majyo_add = 2
		}
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_origin = origin_AL_Sierlint
			}
		}
		text = job_AL_head_majyo_effect_desc
	}
}

# Habitat Central Complex
building_hab_major_capital = {
	base_buildtime = @b2_time
	capital = yes
	can_build = no
	can_demolish = no
	can_be_ruined = no
	can_be_disabled = no
	position_priority = 0

	icon = building_major_capital

	category = government

	potential = {
		uses_habitat_capitals = yes
		exists = owner
		owner = { is_fallen_empire = no }
	}

	convert_to = {
		building_hab_fe_capital
	}

	prerequisites = {
		"tech_habitat_2"
	}

	allow = {
		OR = {
			PR_prmt_trgr_HC = { MORE = 10 }	# |PR转化|
			num_sapient_pops >= 10
		}
	}

	resources = {
		category = planet_buildings_hab_capital
		cost = {
			minerals = @b2_minerals
		}
		upkeep = {
			energy = 3
			alloys = 5
		}
		upkeep = {
			trigger = { owner = { has_active_tradition = tr_expansion_adopt } }
			alloys = -1
		}
	}

	planet_modifier = {
		planet_housing_add = 5
		planet_amenities_add = 5
		planet_max_buildings_add = @buildings_t2
		planet_max_branch_office_buildings_add = 2
		defense_armies_add = @tier_3_capital_defense_armies
		pop_environment_tolerance = 0.10
	}

	inline_script = {
		script = buildings/on_all_capital_buildings
	}

	inline_script = {
		script = buildings/on_all_habitat_capital_buildings
	}

	triggered_planet_modifier = {
		modifier = { planet_stability_add = 1 }
		mult = modifier:habitat_stability_add
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_active_tradition = tr_domination_imperious_architecture
			}
		}
		modifier = {
			planet_housing_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_hive_empire = yes }
		}
		job_synapse_drone_add = 3
		planet_amenities_add = 3
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_machine_empire = yes }
		}
		job_evaluator_add = 2
		job_replicator_add = 1
		job_maintenance_drone_add = 3
		planet_amenities_add = 3
	}

	triggered_desc = {
		text = building_hab_major_capital_tooltip
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_active_tradition = tr_synthetics_prefabricated_components }
		}
		job_roboticist_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_valid_civic = civic_private_healthcare_corporate }
		}
		job_healthcare_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_individual_machine = yes
			}
		}
		job_roboticist_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_pleasure_seeker = yes
			}
		}
		job_entertainer_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_regular_empire = yes
				NOR = {
					has_authority = auth_corporate
					has_civic = civic_exalted_priesthood
					has_civic = civic_aristocratic_elite
					has_civic = civic_merchant_guilds
					has_civic = civic_technocracy
				}
			}
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		modifier = {
			job_politician_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			has_planet_flag = toxic_knights_habitat
			exists = owner
			owner = {
				has_origin = origin_toxic_knights
			}
		}
		modifier = {
			job_knight_commander_add = 1
			job_knight_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			NOT = { has_planet_flag = toxic_knights_habitat }
			exists = owner
			owner = {
				has_authority = auth_corporate
				is_worker_coop_empire = no
			}
		}
		modifier = {
			job_executive_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			NOT = { has_planet_flag = toxic_knights_habitat }
			exists = owner
			owner = {
				has_authority = auth_corporate
				is_worker_coop_empire = yes
			}
		}
		modifier = {
			job_steward_add = 3
		}
	}

	# Exalted Priesthood Civic
	triggered_planet_modifier = {
		potential = {
			exists = owner
			NOT = { has_planet_flag = toxic_knights_habitat }
			owner = {
				has_civic = civic_exalted_priesthood
				NOR = {
					has_origin = origin_toxic_knights
					has_origin = origin_cybernetic_creed
				}
			}
		}
		modifier = {
			job_politician_add = 1
			job_high_priest_add = 1
		}
	}
	triggered_planet_modifier = {
		potential = {
			exists = owner
			NOT = { has_planet_flag = toxic_knights_habitat }
			owner = {
				has_civic = civic_exalted_priesthood
				has_origin = origin_cybernetic_creed # therefore not 'origin_toxic_knights'
			}
		}
		modifier = {
			job_politician_add = 1
			job_technophant_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_civic = civic_aristocratic_elite }
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		modifier = {
			job_politician_add = 1
			job_noble_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_civic = civic_technocracy }
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		modifier = {
			job_head_researcher_add = 1
			job_politician_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_civic = civic_merchant_guilds }
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		modifier = {
			job_politician_add = 1
			job_merchant_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_regular_empire = yes }
		}
		job_enforcer_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_1 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.1
			planet_jobs_productive_produces_mult = 0.1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner.federation
			owner = {
				is_regular_empire = yes
				federation = { has_federation_perk = culture_workers_1 }
			}
		}
		job_culture_worker_add = 1
	}

	triggered_desc = {
		trigger = {
			exists = owner
			NOT = { has_planet_flag = toxic_knights_habitat }
			owner = {
				has_civic = civic_exalted_priesthood
				NOR = {
					has_origin = origin_toxic_knights
					has_origin = origin_cybernetic_creed
				}
			}
		}
		text = job_high_priest_effect_desc
	}
	triggered_desc = {
		trigger = {
			exists = owner
			NOT = { has_planet_flag = toxic_knights_habitat }
			owner = {
				has_civic = civic_exalted_priesthood
				has_origin = origin_cybernetic_creed # therefore not 'origin_toxic_knights'
			}
		}
		text = job_technophant_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_civic = civic_aristocratic_elite
			}
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		text = job_noble_effect_desc
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_civic = civic_merchant_guilds
			}
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		text = job_merchant_effect_desc
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				NOT = { has_authority = auth_corporate }
				is_regular_empire = yes
			}
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		text = job_politician_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_origin = origin_toxic_knights
				NOR = {
					has_country_flag = toxoids_7011_b
					has_country_flag = toxoids_7040_b
					has_country_flag = toxoids_7130_b
				}
			}
			has_planet_flag = toxic_knights_habitat
		}
		text = job_knight_commander_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_origin = origin_toxic_knights
				OR = {
					has_country_flag = toxoids_7011_b
					has_country_flag = toxoids_7040_b
					has_country_flag = toxoids_7130_b
				}
			}
			has_planet_flag = toxic_knights_habitat
		}
		text = job_knight_commander_research_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_origin = origin_toxic_knights
			}
			has_planet_flag = toxic_knights_habitat
		}
		text = job_knight_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				OR = {
					is_individual_machine = yes
					AND = {
						is_regular_empire = yes
						has_active_tradition = tr_synthetics_prefabricated_components
					}
				}
			}
		}
		text = job_roboticist_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_authority = auth_corporate
				is_worker_coop_empire = no
			}
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		text = job_executive_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_authority = auth_corporate
				is_worker_coop_empire = yes
			}
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		text = job_steward_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_regular_empire = yes }
		}
		text = job_enforcer_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { has_valid_civic = civic_private_healthcare_corporate }
		}
		text = job_healthcare_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				is_pleasure_seeker = yes
			}
		}
		text = job_entertainer_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_machine_empire = yes }
		}
		text = job_evaluator_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_machine_empire = yes }
		}
		text = job_replicator_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_machine_empire = yes }
		}
		text = job_maintenance_drone_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_hive_empire = yes }
		}
		text = job_synapse_drone_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner.federation
			owner = {
				is_regular_empire = yes
				federation = { has_federation_perk = culture_workers_1 }
			}
		}
		text = job_culture_worker_effect_desc
	}

	upgrades = {
		"building_hab_system_capital"
	}

	#莉莉修改
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_origin = origin_AL_Sierlint
			}
		}
		modifier = {
			job_AL_head_majyo_add = 2
		}
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_origin = origin_AL_Sierlint
			}
		}
		text = job_AL_head_majyo_effect_desc
	}
}

# Habitat System Complex
building_hab_system_capital = {
	base_buildtime = @b3_time
	capital = yes
	can_build = no
	can_demolish = no
	can_be_ruined = no
	can_be_disabled = no
	position_priority = 0

	icon = building_system_capital

	category = government

	potential = {
		uses_habitat_capitals = yes
		exists = owner
		owner = { is_fallen_empire = no }
	}

	convert_to = {
		building_hab_fe_capital
	}

	prerequisites = {
		"tech_habitat_3"
	}

	allow = {
		OR = {
			PR_prmt_trgr_HC = { MORE = 25 }	# |PR转化|
			num_sapient_pops >= 25
		}
	}

	resources = {
		category = planet_buildings_hab_capital
		cost = {
			minerals = @b3_minerals
		}
		upkeep = {
			energy = 5
			alloys = 5
		}
		upkeep = {
			trigger = { owner = { has_active_tradition = tr_expansion_adopt } }
			alloys = -1
		}
	}

	planet_modifier = {
		planet_housing_add = 8
		planet_amenities_add = 8
		planet_max_buildings_add = @buildings_t3
		planet_max_branch_office_buildings_add = 3
		defense_armies_add = @tier_4_capital_defense_armies
		pop_environment_tolerance = 0.20
	}

	inline_script = {
		script = buildings/on_all_capital_buildings
	}

	inline_script = {
		script = buildings/on_all_habitat_capital_buildings
	}

	triggered_planet_modifier = {
		modifier = { planet_stability_add = 1 }
		mult = modifier:habitat_stability_add
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_active_tradition = tr_domination_imperious_architecture
			}
		}
		modifier = {
			planet_housing_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_hive_empire = yes }
		}
		job_synapse_drone_add = 4
		planet_amenities_add = 3
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_machine_empire = yes }
		}
		job_evaluator_add = 3
		job_replicator_add = 1
		job_maintenance_drone_add = 3
		planet_amenities_add = 3
	}

	triggered_desc = {
		text = building_hab_system_capital_tooltip
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_active_tradition = tr_synthetics_prefabricated_components }
		}
		job_roboticist_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_valid_civic = civic_private_healthcare_corporate }
		}
		job_healthcare_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_pleasure_seeker = yes
			}
		}
		job_entertainer_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_regular_empire = yes
				NOR = {
					has_authority = auth_corporate
					has_civic = civic_exalted_priesthood
					has_civic = civic_aristocratic_elite
					has_civic = civic_merchant_guilds
					has_civic = civic_technocracy
				}
			}
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		modifier = {
			job_politician_add = 3
		}
	}

	triggered_planet_modifier = {
		potential = {
			has_planet_flag = toxic_knights_habitat
			exists = owner
			owner = {
				has_origin = origin_toxic_knights
			}
		}
		modifier = {
			job_knight_commander_add = 1
			job_knight_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			NOT = { has_planet_flag = toxic_knights_habitat }
			exists = owner
			owner = {
				has_authority = auth_corporate
				is_worker_coop_empire = no
			}
		}
		modifier = {
			job_executive_add = 3
		}
	}

	triggered_planet_modifier = {
		potential = {
			NOT = { has_planet_flag = toxic_knights_habitat }
			exists = owner
			owner = {
				has_authority = auth_corporate
				is_worker_coop_empire = yes
			}
		}
		modifier = {
			job_steward_add = 4
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_civic = civic_exalted_priesthood }
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		modifier = {
			job_politician_add = 2
			job_high_priest_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_civic = civic_aristocratic_elite }
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		modifier = {
			job_politician_add = 2
			job_noble_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_civic = civic_technocracy }
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		modifier = {
			job_head_researcher_add = 1
			job_politician_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_civic = civic_merchant_guilds }
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		modifier = {
			job_politician_add = 2
			job_merchant_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_regular_empire = yes }
		}
		job_enforcer_add = 2
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_1 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.2
			planet_jobs_productive_produces_mult = 0.2
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner.federation
			owner = {
				is_regular_empire = yes
				federation = { has_federation_perk = culture_workers_1 }
			}
		}
		job_culture_worker_add = 1
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_civic = civic_exalted_priesthood
			}
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		text = job_high_priest_effect_desc
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_civic = civic_aristocratic_elite
			}
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		text = job_noble_effect_desc
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_civic = civic_merchant_guilds
			}
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		text = job_merchant_effect_desc
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				NOT = { has_authority = auth_corporate }
				is_regular_empire = yes
			}
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		text = job_politician_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_origin = origin_toxic_knights
				NOR = {
					has_country_flag = toxoids_7011_b
					has_country_flag = toxoids_7040_b
					has_country_flag = toxoids_7130_b
				}
			}
			has_planet_flag = toxic_knights_habitat
		}
		text = job_knight_commander_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_origin = origin_toxic_knights
				OR = {
					has_country_flag = toxoids_7011_b
					has_country_flag = toxoids_7040_b
					has_country_flag = toxoids_7130_b
				}
			}
			has_planet_flag = toxic_knights_habitat
		}
		text = job_knight_commander_research_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_origin = origin_toxic_knights
			}
			has_planet_flag = toxic_knights_habitat
		}
		text = job_knight_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { has_active_tradition = tr_synthetics_prefabricated_components }
		}
		text = job_roboticist_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_authority = auth_corporate
				is_worker_coop_empire = no
			}
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		text = job_executive_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_authority = auth_corporate
				is_worker_coop_empire = yes
			}
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		text = job_steward_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_regular_empire = yes }
		}
		text = job_enforcer_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { has_valid_civic = civic_private_healthcare_corporate }
		}
		text = job_healthcare_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				is_pleasure_seeker = yes
			}
		}
		text = job_entertainer_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_machine_empire = yes }
		}
		text = job_evaluator_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_machine_empire = yes }
		}
		text = job_replicator_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_machine_empire = yes }
		}
		text = job_maintenance_drone_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_hive_empire = yes }
		}
		text = job_synapse_drone_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner.federation
			owner = {
				is_regular_empire = yes
				federation = { has_federation_perk = culture_workers_1 }
			}
		}
		text = job_culture_worker_effect_desc
	}

	upgrades = {
		building_imperial_capital
	}
}

##########################

# 08_unity_building
# Servitors
building_organic_sanctuary = {
	#	|PR转化|
	icon = PR_building_CULT_sanctuary_1
	exempt_from_ai_planet_specialization = yes

	base_buildtime = @b1_time

	category = unity

	potential = {
		exists = owner
		owner = { has_valid_civic = civic_machine_servitor }

		OR = {
			owner = { is_ai = no }
			has_upgraded_capital = yes
		}
	}

	destroy_trigger = {
		exists = owner
		OR = {
			owner = {
				NOT = { owner = { has_valid_civic = civic_machine_servitor } }
			}
			AND = {
				owner = { is_ai = yes }
				count_owned_pop = { limit = { has_citizenship_type = { type = citizenship_organic_trophy country = owner } } count <= 20 }
				num_buildings = { type = building_organic_sanctuary value > 3 }
			}
			AND = {
				owner = { is_ai = yes }
				count_owned_pop = { limit = { has_citizenship_type = { type = citizenship_organic_trophy country = owner } } count <= 40 }
				num_buildings = { type = building_organic_paradise value > 5 }
			}
		}
	}

	convert_to = {
		building_luxury_residence
		building_communal_housing
	}

	planet_modifier = {
		job_bio_trophy_add = 10
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b1_minerals
		}
		upkeep = {
			energy = @b1_upkeep
		}
	}

	triggered_desc = {
		text = job_bio_trophy_effect_desc
	}

	upgrades = {
		"building_organic_paradise"
	}

	# We need to cheat here and tell AI that this will probably give some complex output since AI can not evaluate what this building does without the pops which it cant get without the building - chicken and egg
	ai_resource_production = {
		unity = 10
		physics_research = 10
		alloys = 5

		trigger = {
			NOT = { has_building = building_organic_sanctuary }
		}
	}

	ai_weight_coefficient = 1.2

	# Here we try to adress the second issue that the AI cant evaluate the pop job output of the bio trophy given the happiness trigger that was put inplace to guard against players exploiting bio trophies

	#science
	ai_resource_production = {
		unity = 10
		physics_research = 10

		trigger = {
			has_unemployed_pop_of_category = bio_trophy

			planet_resource_compare = {
				resource = physics_research
				value >= 100
				type = produces
			}
		}
	}

	#alloys
	ai_resource_production = {
		unity = 10
		alloys = 10

		trigger = {
			has_unemployed_pop_of_category = bio_trophy

			planet_resource_compare = {
				resource = alloys
				value >= 100
				type = produces
			}
		}
	}

	#cgs
	ai_resource_production = {
		unity = 10
		consumer_goods = 10

		trigger = {
			has_unemployed_pop_of_category = bio_trophy

			planet_resource_compare = {
				resource = consumer_goods
				value >= 100
				type = produces
			}
		}
	}
}

building_organic_paradise = {
	base_buildtime = @b2_time
	can_build = no
	icon = building_paradise_dome

	category = unity

	potential = {
		exists = owner
		owner = { has_valid_civic = civic_machine_servitor }
	}

	destroy_trigger = {
		exists = owner
		NOT = { owner = { has_valid_civic = civic_machine_servitor } }
	}

	convert_to = {
		building_paradise_dome
		building_communal_housing_large
	}

	planet_modifier = {
		job_bio_trophy_add = 20
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b2_minerals
			exotic_gases = @b2_rare_cost
		}
		upkeep = {
			energy = @b2_upkeep
			exotic_gases = @b2_rare_upkeep
		}
	}

	triggered_desc = {
		text = job_bio_trophy_effect_desc
	}

	prerequisites = { "tech_paradise_dome" }

	show_tech_unlock_if = {
		owner = { has_valid_civic = civic_machine_servitor }
	}

	ai_weight_coefficient = 1.2

	# Here we try to adress the second issue that the AI cant evaluate the pop job output of the bio trophy given the happiness trigger that was put inplace to guard against players exploiting bio trophies

	#science
	ai_resource_production = {
		unity = 20
		physics_research = 20

		trigger = {
			has_unemployed_pop_of_category = bio_trophy

			planet_resource_compare = {
				resource = physics_research
				value >= 100
				type = produces
			}
		}
	}

	#alloys
	ai_resource_production = {
		unity = 20
		alloys = 20

		trigger = {
			has_unemployed_pop_of_category = bio_trophy

			planet_resource_compare = {
				resource = alloys
				value >= 100
				type = produces
			}
		}
	}

	#cgs
	ai_resource_production = {
		unity = 20
		consumer_goods = 20

		trigger = {
			has_unemployed_pop_of_category = bio_trophy

			planet_resource_compare = {
				resource = consumer_goods
				value >= 100
				type = produces
			}
		}
	}
}

# 13_fallen_empire_builging
building_clinic = {
	#	|PR转化|
	exempt_from_ai_planet_specialization = yes

	base_buildtime = @b1_time
	base_cap_amount = 1

	category = amenity

	potential = {
		exists = owner
		# rule out Thrall-Worlds
		NOT = { has_modifier = slave_colony }
		# check the empire is valid
		owner = {
			# rule out gestalts and pre-FTL societies
			is_individual_machine = no
			OR = {
				is_regular_empire = yes
				AND = {
					has_origin = origin_fear_of_the_dark
					is_country_type = primitive
				}
			}
			# rule out AI empires with entirely no access to "Pharma State" Civic, unless the planet is unstable
			OR = {
				is_ai = no
				has_valid_civic = civic_private_healthcare_corporate
				prev = {
					has_branch_office = yes
					branch_office_owner = {
						has_valid_civic = civic_private_healthcare_corporate
					}
				}
				prev = {
					NOT = { has_available_jobs = entertainer }
					NOT = { has_forbidden_jobs = entertainer }
					planet_stability < 50
					free_amenities < 0
				}
			}
		}
	}

	destroy_trigger = {
		OR = {
			# if this is now a Thrall-World
			has_modifier = slave_colony
			# if the planet is owned by a gestalt or pre-FTL society
			AND = {
				exists = owner
				owner = {
					OR = {
						is_regular_empire = no
						AND = {
							is_country_type = primitive
							NOT = { has_origin = origin_fear_of_the_dark }
						}
						############
                        ####莉莉修改
                        ############
                        has_origin = origin_AL_irma
					}
				}
			}
			# if this is an AI-controlled empire with entirely no access to "Pharma State" Civic, assuming the planet is now stable
			AND = {
				exists = owner
				owner = {
					is_ai = yes
					NOT = {
						OR = {
							has_valid_civic = civic_private_healthcare_corporate
							prev = {
								has_branch_office = yes
								branch_office_owner = {
									has_valid_civic = civic_private_healthcare_corporate
								}
							}
						}
					}
				}
				planet_stability > 70
				free_amenities > 20
			}
		}
	}
	############
    ####莉莉修改
    ############
    #伊尔马转换
    convert_to = {
        building_irma_pop
    }



	planet_modifier = {
		job_healthcare_add = 2
	}
	
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_technology = tech_gene_tailoring
			}
			any_owned_pop = {
				has_auto_modding_trait = yes
			}
		}
		modifier = {
			auto_mod_monthly_add = 1
		}
	}
	
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_origin = origin_overtuned
			}
			any_owned_pop = {
				has_auto_modding_trait = yes
			}
		}
		modifier = {
			auto_mod_monthly_add = 1
		}
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b1_minerals
		}
		upkeep = {
			energy = @b1_upkeep
		}
	}

	prerequisites = {
		"tech_frontier_health"
	}

	upgrades = {
		"building_hospital"
	}

	triggered_desc = {
		text = job_healthcare_effect_desc
	}

	on_destroy = {
		owner = {
			if = {
				limit = {
					has_event_chain = payback_out_of_warranty_chain
				}
				end_event_chain = payback_out_of_warranty_chain
			}
		}
	}

	on_repaired = {
		if = {
			limit = {
				planet.owner = {
					has_event_chain = payback_out_of_warranty_chain
				}
			}
			random_list = {
				50 = { # still broken
					planet.owner = {
						country_event = { id = origin.4302 }
					}
					modifier = {
						factor = 0
						planet.owner = { has_technology = tech_frontier_health }
					}
				}
				20 = { # repaired
					planet.owner = {
						country_event = { id = origin.4301 }
					}
					modifier = {
						factor = 2
						planet.owner = { num_research_agreements = 1 }
					}
					modifier = {
						factor = 3
						planet.owner = { num_research_agreements = 2 }
					}
					modifier = {
						factor = 4
						planet.owner = { num_research_agreements >= 3 }
					}
				}
				10 = { # broken beyond repair
					planet = {
						planet_event = { id = origin.4303 }
					}
				}
			}
		}
	}
}

building_ancient_cryo_chamber = {
	base_buildtime = @b2_time
	can_build = no
	can_demolish = yes

	category = government

	potential = {
	}

	country_modifier = {
		category_biology_research_speed_mult = 0.1
	}

	triggered_country_modifier = {
		potential = {
			exists = owner
			owner = {
				is_fallen_empire = no
			}
		}
		BIOLOGICAL_species_trait_points_add = 1
		Magical_Bitch_species_trait_points_add = 1
		PARASITE_species_trait_points_add = 1
		Magical_Girl_trait_points_add = 1
		MONSTER_species_trait_points_add = 1
		TENTACLE_species_trait_points_add = 1
		Lust_Girl_species_trait_points_add = 1
		Erotic_Creation_species_trait_points_add = 1
		NYTO_species_trait_points_add = 1
		EILD_species_trait_points_add = 1
		WARSHIPGIRL_species_trait_points_add = 1
		SHENHAI_species_trait_points_add = 1
		UNITED_FLEET_species_trait_points_add = 1
		LILY_species_trait_points_add = 1
		STARSHIPGIRLS_species_trait_points_add = 1
		Dolls_species_trait_points_add = 1
		TOUHOUGIRLS_species_trait_points_add = 1
		BIOLOGICAL_species_trait_picks_add = 1
		Magical_Bitch_species_trait_picks_add = 1
		PARASITE_trait_picks_add = 1
		Magical_Girl_trait_picks_add = 1
		MONSTER_species_trait_picks_add = 1
		TENTACLE_species_trait_picks_add = 1
		Lust_Girl_species_trait_picks_add = 1
		Erotic_Creation_species_trait_picks_add = 1
		NYTO_species_trait_picks_add = 1
		EILD_species_trait_picks_add = 1
		WARSHIPGIRL_species_trait_picks_add = 1
		SHENHAI_species_trait_picks_add = 1
		UNITED_FLEET_species_trait_picks_add = 1
		LILY_species_trait_picks_add = 1
		STARSHIPGIRLS_species_trait_picks_add = 1
		Dolls_species_trait_picks_add = 1
		TOUHOUGIRLS_species_trait_picks_add = 1
	}

	resources = {
		category = planet_buildings
		cost = {
			alloys = @b2_minerals
		}
		upkeep = {
			sr_living_metal = 1
			energy = 50
		}
	}

	upgrades = {
		building_repair_the_ancient_cryo_chamber
	}

	triggered_desc = {
		trigger = { owner = { has_valid_civic = civic_machine_servitor } }
		text = building_ancient_cryo_chamber_effect_desc
	}
}

building_repair_the_ancient_cryo_chamber = {
	base_buildtime = @b1_time
	icon = building_repaired_cryo_chamber
	can_build = no
	
	category = government

	potential = {
		owner = { has_valid_civic = civic_machine_servitor }
	}
	allow = {
		has_upgraded_capital = yes
	}

	country_modifier = {
		category_biology_research_speed_mult = 0.2
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b1_minerals
			exotic_gases = @b2_rare_cost
		}
		upkeep = {
			energy = @b3_upkeep
			exotic_gases = @b3_rare_upkeep
		}
	}

	triggered_country_modifier = {
		potential = {
			exists = owner
			owner = {
				is_fallen_empire = no
			}
		}
		BIOLOGICAL_species_trait_points_add = 2
		Magical_Bitch_species_trait_points_add = 2
		PARASITE_species_trait_points_add = 2
		Magical_Girl_trait_points_add = 2
		MONSTER_species_trait_points_add = 2
		TENTACLE_species_trait_points_add = 2
		Lust_Girl_species_trait_points_add = 2
		Erotic_Creation_species_trait_points_add = 2
		NYTO_species_trait_points_add = 2
		EILD_species_trait_points_add = 2
		WARSHIPGIRL_species_trait_points_add = 2
		SHENHAI_species_trait_points_add = 2
		UNITED_FLEET_species_trait_points_add = 2
		LILY_species_trait_points_add = 2
		STARSHIPGIRLS_species_trait_points_add = 2
		Dolls_species_trait_points_add = 2
		TOUHOUGIRLS_species_trait_points_add = 2
		BIOLOGICAL_species_trait_picks_add = 2
		Magical_Bitch_species_trait_picks_add = 2
		PARASITE_trait_picks_add = 2
		Magical_Girl_trait_picks_add = 2
		MONSTER_species_trait_picks_add = 2
		TENTACLE_species_trait_picks_add = 2
		Lust_Girl_species_trait_picks_add = 2
		Erotic_Creation_species_trait_picks_add = 2
		NYTO_species_trait_picks_add = 2
		EILD_species_trait_picks_add = 2
		WARSHIPGIRL_species_trait_picks_add = 2
		SHENHAI_species_trait_picks_add = 2
		UNITED_FLEET_species_trait_picks_add = 2
		LILY_species_trait_picks_add = 2
		STARSHIPGIRLS_species_trait_picks_add = 2
		Dolls_species_trait_picks_add = 2
		TOUHOUGIRLS_species_trait_picks_add = 2
	}

	triggered_desc = {
		text = job_hibernation_effect_desc
	}
}

building_holo_theatres = {
	#	|PR转化|
	exempt_from_ai_planet_specialization = yes

	base_buildtime = @b1_time

	category = amenity

	potential = {
		NOT = {	has_modifier = slave_colony	}
		owner = {
			is_regular_empire = yes
			NOT = { has_valid_civic = civic_dystopian_society }
		}
		OR = {
			owner = {
				NOT = { is_ai = yes }
			}
			AND = {
				NOT = { has_available_jobs = entertainer }
				NOT = { has_forbidden_jobs = entertainer }
			}
		}
		NOT = { has_building = building_low_tech_capital }
	}

	destroy_trigger = {
		exists = owner
		OR = {
			owner = { is_regular_empire = no }
			owner = { has_valid_civic = civic_dystopian_society }
			has_modifier = slave_colony
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				NOT = { has_valid_civic = civic_warrior_culture }
			}
		}
		modifier = {
			job_entertainer_add = @b1_jobs
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_valid_civic = civic_warrior_culture
			}
		}
		modifier = {
			job_duelist_add = @b1_jobs
		}
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b1_minerals
		}
		upkeep = {
			energy = @b1_upkeep
		}
	}

	upgrades = {
		"building_hyper_entertainment_forum"
	}

	prerequisites = {
		"tech_holo_entertainment"
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				NOT = { has_valid_civic = civic_warrior_culture }
			}
		}
		text = job_entertainer_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_valid_civic = civic_warrior_culture
			}
		}
		text = job_duelist_effect_desc
	}
	    #莉莉修改
		triggered_planet_modifier = {
			potential = {
				exists = owner
				owner = {
					has_origin = origin_AL_kanba
				}
			}
			modifier = {
				job_entertainer_add = @b1_jobs
				job_duelist_add = @b1_jobs
			}
		}
}

building_hyper_entertainment_forum = {
	base_buildtime = @b2_time
	can_build = no

	category = amenity

	potential = {
		has_building = building_holo_theatres
	}

	allow = {
		has_upgraded_capital = yes
		owner = {
			NOT = { has_valid_civic = civic_dystopian_society }
		}
		OR = {
			owner = {
				NOT = { is_ai = yes }
			}
			AND = {
				NOT = { has_available_jobs = entertainer }
				NOT = { has_forbidden_jobs = entertainer }
			}
		}
	}

	destroy_trigger = {
		exists = owner
		owner = { has_valid_civic = civic_dystopian_society }
		OR = {
			owner = { is_regular_empire = no }
			has_modifier = slave_colony
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				NOT = { has_valid_civic = civic_warrior_culture }
			}
		}
		modifier = {
			job_entertainer_add = @b2_jobs
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_valid_civic = civic_warrior_culture
			}
		}
		modifier = {
			job_duelist_add = @b2_jobs
		}
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b2_minerals
			exotic_gases = @b2_rare_cost
		}
		upkeep = {
			energy = @b2_upkeep
			exotic_gases = @b2_rare_upkeep
		}
	}

	prerequisites = {
		"tech_hyper_entertainment_forum"
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				NOT = { has_valid_civic = civic_warrior_culture }
			}
		}
		text = job_entertainer_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_valid_civic = civic_warrior_culture
			}
		}
		text = job_duelist_effect_desc
	}
	    #莉莉修改
		triggered_planet_modifier = {
			potential = {
				exists = owner
				owner = {
					has_origin = origin_AL_kanba
				}
			}
			modifier = {
				job_entertainer_add = @b2_jobs
				job_duelist_add = @b2_jobs
			}
		}
}

# 00_government_building
#警署
building_precinct_house = {
	#	|PR转化|
	exempt_from_ai_planet_specialization = yes

	base_buildtime = @b1_time

	category = government

	potential = {
		owner = { 
			is_regular_empire = yes 
			NOT = {
                has_origin = origin_AL_sagamihara
            }
		}
		NOT = { has_modifier = slave_colony }
	}

	allow = {
		hidden_trigger = {
			OR = {
				owner = { is_ai = no }
				AND = {
					NOT = { has_forbidden_jobs = enforcer }
					NOT = { has_available_jobs = enforcer }
				}
			}
		}
	}

	destroy_trigger = {
		exists = owner
		OR = {
			NOT = {	owner = { is_regular_empire = yes }	}
			AND = {
				owner = { is_ai = yes } #Players dont like random buildings blowing up
				planet = { has_building = building_hall_judgment }
			}#This way the AI gets to reclaim its building slots that it sunk into this expense
		}
	}

	planet_modifier = {
		job_enforcer_add = 2
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b1_minerals
		}
		upkeep = {
			energy = 2
		}
	}

	prerequisites = {
		"tech_planetary_government"
	}

	triggered_desc = {
		text = job_enforcer_effect_desc
	}

	show_tech_unlock_if = {
		is_regular_empire = yes
	}

	upgrades = {
		building_hall_judgment
	}
}

#############
# Science buildings
#############
# 05_research_building
building_research_lab_1 = {
	#	|PR转化|
	convert_to = {
		PR_building_TECH_lab_1
	}

	base_buildtime = @b1_time
	exempt_from_ai_planet_specialization = no
	category = research
	potential = {
		NOR = {
			has_planet_flag = PR_flg_plnt_VALID	# |PR转化|
			has_modifier = resort_colony
			has_modifier = slave_colony
			owner = {
				has_origin = origin_AL_Sierlint
			}
		}
	}
	destroy_trigger = {
		OR = {
			has_planet_flag = PR_flg_plnt_VALID	# |PR转化|
			has_modifier = resort_colony
			has_modifier = slave_colony
			owner = {
				has_origin = origin_AL_Sierlint
			}
		}
	}
	inline_script = {
		script = jobs/researchers_add
		AMOUNT = @b1_jobs
	}
	resources = {
		category = planet_buildings
		cost = {
			minerals = @b1_minerals
		}
		upkeep = {
			energy = @b1_upkeep
		}
	}
	upgrades = {
		"building_research_lab_2"
	}
	prerequisites = {
		"tech_basic_science_lab_1"
	}
}

#####################################
