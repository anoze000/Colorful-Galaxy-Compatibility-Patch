@buildings_t1 = 1
@buildings_t2 = 2
@buildings_t3 = 3
@buildings_t4 = 4

@tier_2_capital_defense_armies = 4
@tier_3_capital_defense_armies = 8
@tier_4_capital_defense_armies = 16

#############
# Robot buildings
#############

building_robot_assembly_plant = {
	base_buildtime = @b1_time
	base_cap_amount = 1

	category = pop_assembly

	potential = {
		exists = owner
		OR = {
			owner = { 
				is_ai = no 
			}
			NOT = { 
				exists = assembling_species 
			}
			assembling_species = { 
				is_robotic_species = yes 
			}
		}
		owner = {
			is_regular_empire = yes
			is_individual_machine = no
			NOT = { 
				has_policy_flag = robots_outlawed 
			}
			OR = {
				is_ai = no
				NOT = { 
					has_ascension_perk = ap_engineered_evolution 
				}
				is_materialist = yes
			}
		}
		NOR = { 
			has_modifier = slave_colony
			has_modifier = resort_colony
		}
	}

	convert_to = {
		building_machine_assembly_plant
	}

	upgrades = {
		building_robot_assembly_complex
	}

	allow = {
		hidden_trigger = {
			OR = {
				owner = { 
					is_ai = no 
				}
				NAND = {
					free_district_slots = 0
					free_building_slots <= 1
					free_housing <= 0
					free_jobs <= 0
				}
			}
		}
	}

	destroy_trigger = {
		exists = owner
		OR = {
			owner = {
				OR = {
					is_regular_empire = no
					has_policy_flag = robots_outlawed
				}
			}
			has_modifier = slave_colony
			AND = {
				owner = { 
					is_ai = yes 
				}
				free_district_slots = 0
				free_building_slots = 0
				free_housing <= 0
				free_jobs <= 0
			}
			owner = {
				is_ai = yes
				has_ascension_perk = ap_engineered_evolution
				is_materialist = no
			}
		}
	}

	triggered_planet_modifier = {
		potential = {
			owner = {
				is_futa_country = no
			}
		}
		modifier = {
			job_roboticist_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			owner = {
				is_futa_country = yes
			}
		}
		modifier = {
			job_futa_assembly_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				OR = {
					has_origin = origin_mechanists
					is_individual_machine = yes
					has_country_flag = synthetic_empire
				}
			}
			any_owned_pop = {
				has_auto_modding_trait = yes
			}
		}
		modifier = {
			auto_mod_monthly_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_country_flag = synth_unscheduled_updates
			}
		}
		modifier = {
			planet_pop_assembly_mult = 0.1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_country_flag = synth_safe_updates
			}
		}
		modifier = {
			planet_pop_assembly_mult = -0.1
			planet_stability_add = 5
		}
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b2_minerals
		}
		upkeep = {
			energy = @b2_upkeep
		}
	}

	triggered_desc = {
		text = job_roboticist_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				is_futa_country = no
				has_policy_flag = roboticist_output_build_cyborgs
			}
		}
		text = job_roboticist_cyborg_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				is_futa_country = yes
			}
		}
		text = job_futa_assembly_effect_desc
	}
	triggered_desc = {
		trigger = {
			OR = {
				has_building = building_clone_vats
				has_building = building_clone_army_clone_vat
				has_building = building_posthumous_employment_center
				AND = {
					exists = assembling_species
					assembling_species = {
						is_organic_species = yes
					}
					exists = owner
				}
			}
		}
		text = tooltip_organic_and_artificial_assembly_warning
	}

	prerequisites = {
		"tech_robotic_workers"
	}
}

building_robot_assembly_complex = {
	icon = building_machine_assembly_complex
	base_buildtime = @b3_time
	can_build = no

	category = pop_assembly

	potential = {
		exists = owner
		OR = {
			owner = { 
				is_ai = no 
			}
			NOT = { 
				exists = assembling_species 
			}
			assembling_species = { 
				is_robotic_species = yes 
			}
		}
		owner = {
			is_regular_empire = yes
			is_individual_machine = no
			NOT = { 
				has_policy_flag = robots_outlawed 
			}
			OR = {
				is_ai = no
				NOT = { 
					has_ascension_perk = ap_engineered_evolution 
				}
				is_materialist = yes
			}
		}
		NOT = { 
			has_modifier = slave_colony 
		}
	}

	convert_to = {
		building_machine_assembly_complex
	}

	destroy_trigger = {
		exists = owner
		OR = {
			owner = {
				OR = {
					is_regular_empire = no
					has_policy_flag = robots_outlawed
				}
			}
			has_modifier = slave_colony
			AND = {
				owner = { 
					is_ai = yes 
				}
				free_district_slots = 0
				free_building_slots = 0
				free_housing <= 0
				free_jobs <= 0
			}
			owner = {
				is_ai = yes
				has_ascension_perk = ap_engineered_evolution
				is_materialist = no
			}
		}
	}

	# planet_modifier = {
	# 	job_roboticist_add = 2
	# }
	triggered_planet_modifier = {
		potential = {
			owner = {
				is_futa_country = no
			}
		}
		modifier = {
			job_roboticist_add = 2
		}
	}
	triggered_planet_modifier = {
		potential = {
			owner = {
				is_futa_country = yes
			}
		}
		modifier = {
			job_futa_assembly_add = 2
		}
	}
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				OR = {
					has_origin = origin_mechanists
					is_individual_machine = yes
					has_country_flag = synthetic_empire
				}
			}
			any_owned_pop = {
				has_auto_modding_trait = yes
			}
		}
		modifier = {
			auto_mod_monthly_add = 4
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_country_flag = synth_unscheduled_updates
			}
		}
		modifier = {
			planet_pop_assembly_mult = 0.1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_country_flag = synth_safe_updates
			}
		}
		modifier = {
			planet_pop_assembly_mult = -0.1
			planet_stability_add = 5
		}
	}
	resources = {
		category = planet_buildings
		cost = {
			minerals = @b3_minerals
			rare_crystals = @b3_rare_cost
		}
		upkeep = {
			energy = @b3_upkeep
			rare_crystals = @b3_rare_upkeep
		}
	}
	prerequisites = {
		tech_robot_assembly_complex
	}
	triggered_desc = {
		text = job_roboticist_effect_desc
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				is_futa_country = yes
			}
		}
		text = job_futa_assembly_effect_desc
	}

	triggered_desc = {
		trigger = {
			OR = {
				has_building = building_clone_vats
				has_building = building_clone_army_clone_vat
				has_building = building_posthumous_employment_center
				AND = {
					exists = assembling_species
					assembling_species = {
						is_organic_species = yes
					}
					exists = owner
				}
			}
		}
		text = tooltip_organic_and_artificial_assembly_warning
	}
}

#############
# Capital buildings
#############
# Planetary Administration
building_capital = {
	base_buildtime = @b2_time
	capital = yes
	can_build = no
	can_demolish = no
	can_be_ruined = no
	can_be_disabled = no
	position_priority = 0

	category = government

	potential = {
		exists = owner
		owner = {
			is_regular_empire = yes
			is_fallen_empire = no
		}
		NOR = {
			has_modifier = resort_colony
			has_modifier = slave_colony
			uses_habitat_capitals = yes
			is_planet_class = pc_cosmogenesis_world
		}
	}

	convert_to = {
		building_hive_capital
		building_machine_capital
		building_resort_capital
		building_slave_capital
		building_ancient_control_center
		building_ancient_palace
		building_capital_nanotech
	}

	allow = {
		OR = {
			PR_prmt_trgr_HC = { 
				MORE = 10 
			}
			num_sapient_pops >= 10
		}
	}

	upgrades = {
		"building_major_capital"
	}

	prerequisites = {
		"tech_planetary_government"
	}

	show_tech_unlock_if = {
		is_regular_empire = yes
	}

	planet_modifier = {
		job_enforcer_add = 1
		planet_housing_add = 5
		planet_amenities_add = 5
		planet_max_buildings_add = @buildings_t2
		planet_max_branch_office_buildings_add = 1
		defense_armies_add = @tier_2_capital_defense_armies
	}

	inline_script = {
		script = buildings/on_all_capital_buildings
	}

	inline_script = {
		script = buildings/regular_empire_capital_jobs
		PRIMARY_JOB = 1
		SECONDARY_JOB = 1
		TERTIARY_JOB = 2
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner.federation
			owner.federation = { has_federation_perk = culture_workers_1 }
		}
		job_culture_worker_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_active_tradition = tr_domination_imperious_architecture
			}
		}
		modifier = {
			planet_housing_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_1 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.1
			planet_jobs_productive_produces_mult = 0.1
		}
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b2_minerals
		}
		upkeep = {
			energy = @b2_upkeep
		}
	}

	triggered_desc = {
		text = job_enforcer_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner.federation
			owner.federation = { has_federation_perk = culture_workers_1 }
		}
		text = job_culture_worker_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				is_pleasure_seeker = yes
			}
		}
		text = job_entertainer_effect_desc
	}

	triggered_desc = {
		trigger = {
			has_modifier = payback_unified_purpose
		}
		text = job_unifier_effect_desc
	}

	#莉莉修改
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_origin = origin_AL_Sierlint
			}
		}
		modifier = {
			job_AL_head_majyo_add = 1
		}
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_origin = origin_AL_Sierlint
			}
		}
		text = job_AL_head_majyo_effect_desc
	}
}

# Major Capital
building_major_capital = {
	base_buildtime = @b3_time
	capital = yes
	can_build = no
	can_demolish = no
	can_be_ruined = no
	can_be_disabled = no
	position_priority = 0

	category = government

	potential = {
		exists = owner
		owner = {
			is_regular_empire = yes
			is_fallen_empire = no
		}
		NOR = {
			has_modifier = resort_colony
			has_modifier = slave_colony
		}
	}

	allow = {
		OR = {
			PR_prmt_trgr_HC = { 
				MORE = 25 
			}
			num_sapient_pops >= 25
		}
	}

	convert_to = {
		building_hive_major_capital
		building_machine_major_capital
		building_resort_major_capital
		building_slave_major_capital
		building_ancient_control_center
		building_ancient_palace
		building_major_capital_nanotech
	}

	prerequisites = {
		"tech_colonial_centralization"
	}

	show_tech_unlock_if = {
		is_regular_empire = yes
	}

	planet_modifier = {
		job_enforcer_add = 2
		planet_housing_add = 8
		planet_amenities_add = 8
		planet_max_buildings_add = @buildings_t3
		planet_max_branch_office_buildings_add = 2
		defense_armies_add = @tier_3_capital_defense_armies
	}

	inline_script = {
		script = buildings/on_all_capital_buildings
	}

	inline_script = {
		script = buildings/regular_empire_capital_jobs
		PRIMARY_JOB = 2
		SECONDARY_JOB = 1
		TERTIARY_JOB = 2
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_active_tradition = tr_domination_imperious_architecture
			}
		}
		modifier = {
			planet_housing_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_1 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.1
			planet_jobs_productive_produces_mult = 0.1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_2 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.1
			planet_jobs_productive_produces_mult = 0.1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner.federation
			owner.federation = { has_federation_perk = culture_workers_1 }
		}
		job_culture_worker_add = 1
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b3_minerals
		}
		upkeep = {
			energy = @b3_upkeep
		}
	}

	triggered_desc = {
		text = job_enforcer_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { has_valid_civic = civic_private_healthcare_corporate }
		}
		text = job_healthcare_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner.federation
			owner.federation = { has_federation_perk = culture_workers_1 }
		}
		text = job_culture_worker_effect_desc
	}

	triggered_desc = {
		trigger = {
			has_modifier = payback_unified_purpose
		}
		text = job_unifier_effect_desc
	}

	upgrades = {
		"building_system_capital"
	}

	#莉莉修改
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_origin = origin_AL_Sierlint
			}
		}
		modifier = {
			job_AL_head_majyo_add = 1
		}
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_origin = origin_AL_Sierlint
			}
		}
		text = job_AL_head_majyo_effect_desc
	}
}

building_system_capital = {
	base_buildtime = @b4_time
	capital = yes
	can_build = no
	can_demolish = no
	can_be_ruined = no
	can_be_disabled = no
	position_priority = 0

	category = government

	potential = {
		exists = owner
		owner = {
			is_regular_empire = yes
			is_fallen_empire = no
		}
		NOR = {
			has_modifier = resort_colony
			has_modifier = slave_colony
		}
	}

	convert_to = {
		building_hive_major_capital
		building_machine_major_capital
		building_major_capital
		building_resort_major_capital
		building_slave_major_capital
		building_ancient_control_center
		building_ancient_palace
		building_system_capital_nanotech
	}

	allow = {
		OR = {
			PR_prmt_trgr_HC = { 
				MORE = 50 
			}
			num_sapient_pops >= 50
		}
	}

	prerequisites = {
		"tech_galactic_administration"
	}

	show_tech_unlock_if = {
		is_regular_empire = yes
	}

	planet_modifier = {
		job_enforcer_add = 3
		planet_housing_add = 12
		planet_amenities_add = 12
		planet_max_buildings_add = @buildings_t4
		planet_max_branch_office_buildings_add = 4
		defense_armies_add = @tier_4_capital_defense_armies
	}

	inline_script = {
		script = buildings/on_all_capital_buildings
	}

	inline_script = {
		script = buildings/regular_empire_capital_jobs
		PRIMARY_JOB = 2
		SECONDARY_JOB = 2
		TERTIARY_JOB = 2
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_active_tradition = tr_domination_imperious_architecture
			}
		}
		modifier = {
			planet_housing_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_active_tradition = tr_domination_imperious_architecture
			}
		}
		modifier = {
			planet_housing_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_1 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.1
			planet_jobs_productive_produces_mult = 0.1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_2 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.1
			planet_jobs_productive_produces_mult = 0.1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_3 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.1
			planet_jobs_productive_produces_mult = 0.1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner.federation
			owner.federation = { has_federation_perk = culture_workers_1 }
		}
		job_culture_worker_add = 2
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b4_minerals
		}
		upkeep = {
			energy = @b4_upkeep
		}
	}

	triggered_desc = {
		text = job_enforcer_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner.federation
			owner.federation = { has_federation_perk = culture_workers_1 }
		}
		text = job_culture_worker_effect_desc
	}

	triggered_desc = {
		trigger = {
			has_modifier = payback_unified_purpose
		}
		text = job_unifier_effect_desc
	}

	upgrades = {
		building_imperial_capital
	}

	#莉莉修改
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_origin = origin_AL_Sierlint
			}
		}
		modifier = {
			job_AL_head_majyo_add = 2
		}
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_origin = origin_AL_Sierlint
			}
		}
		text = job_AL_head_majyo_effect_desc
	}
}

#############
# Habitat buildings
#############

# Habitat Administration
building_hab_capital = {
	capital = yes
	can_build = no
	can_demolish = no
	can_be_ruined = no
	can_be_disabled = no
	position_priority = 0

	icon = building_capital

	category = government

	potential = {
		uses_habitat_capitals = yes
		exists = owner
		owner = { is_fallen_empire = no }
	}

	convert_to = {
		building_hab_fe_capital
	}

	prerequisites = {
		"tech_habitat_1"
	}

	resources = {
		category = planet_buildings_hab_capital
		upkeep = {
			energy = 3
			alloys = 5
		}
		upkeep = {
			trigger = { owner = { has_active_tradition = tr_expansion_adopt } }
			alloys = -1
		}
		inline_script = { ############ 女仆调整资源
			script = maid_buildings_change/maid_capital_building_additional_upkeep
			BASE = 1
		}
	}

	planet_modifier = {
		planet_housing_add = 3
		planet_amenities_add = 3
		planet_max_buildings_add = @buildings_t1
		defense_armies_add = @tier_2_capital_defense_armies
	}

	inline_script = {
		script = buildings/on_all_capital_buildings
	}

	inline_script = {
		script = buildings/on_all_habitat_capital_buildings
	}

	triggered_planet_modifier = {
		modifier = { planet_stability_add = 1 }
		mult = modifier:habitat_stability_add
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_active_tradition = tr_domination_imperious_architecture
			}
		}
		modifier = {
			planet_housing_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_active_tradition = tr_synthetics_finish }
		}
		job_roboticist_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_valid_civic = civic_private_healthcare_corporate }
		}
		job_healthcare_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_individual_machine = yes
			}
		}
		job_roboticist_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_pleasure_seeker = yes
			}
		}
		job_entertainer_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				NOT = {
					has_authority = auth_corporate
				}
				is_regular_empire = yes
			}
		}
		job_politician_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_authority = auth_corporate
				is_worker_coop_empire = no
			}
		}
		modifier = {
			job_executive_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_authority = auth_corporate
				is_worker_coop_empire = yes
			}
		}
		modifier = {
			job_steward_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_civic = civic_dystopian_society }
		}
		modifier = {
			job_enforcer_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_hive_empire = yes }
		}
		job_synapse_drone_add = 2
		planet_amenities_add = 3
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_machine_empire = yes }
		}
		job_evaluator_add = 1
		job_replicator_add = 1
		job_maintenance_drone_add = 2
		planet_amenities_add = 3
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				is_regular_empire = yes
				has_valid_civic = civic_dystopian_society
			}
		}
		text = job_enforcer_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				NOT = {
					has_authority = auth_corporate
				}
				is_regular_empire = yes
			}
		}
		text = job_politician_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				OR = {
					is_individual_machine = yes
					AND = {
						is_regular_empire = yes
						has_active_tradition = tr_synthetics_finish
					}
				}
			}
		}
		text = job_roboticist_effect_desc
	}

	inline_script = { ############ 女仆调整修正
		script = maid_buildings_change/maid_capital_building_jobs_and_modifiers_hab
		JOB = 1
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				is_megacorp = yes
				is_worker_coop_empire = no
			}
		}
		text = job_executive_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				is_megacorp = yes
				is_worker_coop_empire = yes
			}
		}
		text = job_steward_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { has_valid_civic = civic_private_healthcare_corporate }
		}
		text = job_healthcare_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				is_pleasure_seeker = yes
			}
		}
		text = job_entertainer_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_machine_empire = yes }
		}
		text = job_evaluator_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_machine_empire = yes }
		}
		text = job_replicator_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_machine_empire = yes }
		}
		text = job_maintenance_drone_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_hive_empire = yes }
		}
		text = job_synapse_drone_effect_desc
	}

	upgrades = {
		"building_hab_major_capital"
	}
	# 莉莉修改
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_origin = origin_AL_Sierlint
			}
		}
		modifier = {
			job_AL_head_majyo_add = 2
		}
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_origin = origin_AL_Sierlint
			}
		}
		text = job_AL_head_majyo_effect_desc
	}
}

# Habitat Central Complex
building_hab_major_capital = {
	base_buildtime = @b2_time
	capital = yes
	can_build = no
	can_demolish = no
	can_be_ruined = no
	can_be_disabled = no
	position_priority = 0

	icon = building_major_capital

	category = government

	potential = {
		uses_habitat_capitals = yes
		exists = owner
		owner = { is_fallen_empire = no }
	}

	convert_to = {
		building_hab_fe_capital
	}

	prerequisites = {
		"tech_habitat_2"
	}

	allow = {
		OR = {
			PR_prmt_trgr_HC = { 
				MORE = 10 
			}
			num_sapient_pops >= 10
		}
	}

	resources = {
		category = planet_buildings_hab_capital
		cost = {
			minerals = @b2_minerals
		}
		upkeep = {
			energy = 3
			alloys = 5
		}
		upkeep = {
			trigger = { owner = { has_active_tradition = tr_expansion_adopt } }
			alloys = -1
		}
		inline_script = { ############ 女仆调整资源
			script = maid_buildings_change/maid_capital_building_additional_upkeep
			BASE = 2
		}
	}

	planet_modifier = {
		planet_housing_add = 5
		planet_amenities_add = 5
		planet_max_buildings_add = @buildings_t2
		planet_max_branch_office_buildings_add = 2
		defense_armies_add = @tier_3_capital_defense_armies
		pop_environment_tolerance = 0.10
	}

	inline_script = {
		script = buildings/on_all_capital_buildings
	}

	inline_script = {
		script = buildings/on_all_habitat_capital_buildings
	}

	triggered_planet_modifier = {
		modifier = { planet_stability_add = 1 }
		mult = modifier:habitat_stability_add
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_active_tradition = tr_domination_imperious_architecture
			}
		}
		modifier = {
			planet_housing_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_hive_empire = yes }
		}
		job_synapse_drone_add = 3
		planet_amenities_add = 3
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_machine_empire = yes }
		}
		job_evaluator_add = 2
		job_replicator_add = 1
		job_maintenance_drone_add = 3
		planet_amenities_add = 3
	}

	triggered_desc = {
		text = building_hab_major_capital_tooltip
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_active_tradition = tr_synthetics_finish }
		}
		job_roboticist_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_valid_civic = civic_private_healthcare_corporate }
		}
		job_healthcare_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_individual_machine = yes
			}
		}
		job_roboticist_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_pleasure_seeker = yes
			}
		}
		job_entertainer_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_regular_empire = yes
				NOR = {
					has_authority = auth_corporate
					has_civic = civic_exalted_priesthood
					has_civic = civic_aristocratic_elite
					has_civic = civic_merchant_guilds
					has_civic = civic_technocracy
				}
			}
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		modifier = {
			job_politician_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			has_planet_flag = toxic_knights_habitat
			exists = owner
			owner = {
				has_origin = origin_toxic_knights
			}
		}
		modifier = {
			job_knight_commander_add = 1
			job_knight_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			NOT = { has_planet_flag = toxic_knights_habitat }
			exists = owner
			owner = {
				has_authority = auth_corporate
				is_worker_coop_empire = no
			}
		}
		modifier = {
			job_executive_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			NOT = { has_planet_flag = toxic_knights_habitat }
			exists = owner
			owner = {
				has_authority = auth_corporate
				is_worker_coop_empire = yes
			}
		}
		modifier = {
			job_steward_add = 3
		}
	}

	# Exalted Priesthood Civic
	triggered_planet_modifier = {
		potential = {
			exists = owner
			NOT = { has_planet_flag = toxic_knights_habitat }
			owner = {
				has_civic = civic_exalted_priesthood
				NOR = {
					has_origin = origin_toxic_knights
					has_origin = origin_cybernetic_creed
				}
			}
		}
		modifier = {
			job_politician_add = 1
			job_high_priest_add = 1
		}
	}
	triggered_planet_modifier = {
		potential = {
			exists = owner
			NOT = { has_planet_flag = toxic_knights_habitat }
			owner = {
				has_civic = civic_exalted_priesthood
				has_origin = origin_cybernetic_creed # therefore not 'origin_toxic_knights'
			}
		}
		modifier = {
			job_politician_add = 1
			job_technophant_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_civic = civic_aristocratic_elite }
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		modifier = {
			job_politician_add = 1
			job_noble_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_civic = civic_technocracy }
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		modifier = {
			job_head_researcher_add = 1
			job_politician_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_civic = civic_merchant_guilds }
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		modifier = {
			job_politician_add = 1
			job_merchant_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_regular_empire = yes }
		}
		job_enforcer_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_1 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.1
			planet_jobs_productive_produces_mult = 0.1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner.federation
			owner = {
				is_regular_empire = yes
				federation = { has_federation_perk = culture_workers_1 }
			}
		}
		job_culture_worker_add = 1
	}

	inline_script = { ############ 女仆调整修正
		script = maid_buildings_change/maid_capital_building_jobs_and_modifiers_hab
		JOB = 2
	}

	triggered_desc = {
		trigger = {
			exists = owner
			NOT = { has_planet_flag = toxic_knights_habitat }
			owner = {
				has_civic = civic_exalted_priesthood
				NOR = {
					has_origin = origin_toxic_knights
					has_origin = origin_cybernetic_creed
				}
			}
		}
		text = job_high_priest_effect_desc
	}
	triggered_desc = {
		trigger = {
			exists = owner
			NOT = { has_planet_flag = toxic_knights_habitat }
			owner = {
				has_civic = civic_exalted_priesthood
				has_origin = origin_cybernetic_creed # therefore not 'origin_toxic_knights'
			}
		}
		text = job_technophant_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_civic = civic_aristocratic_elite
			}
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		text = job_noble_effect_desc
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_civic = civic_merchant_guilds
			}
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		text = job_merchant_effect_desc
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				NOT = { has_authority = auth_corporate }
				is_regular_empire = yes
			}
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		text = job_politician_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_origin = origin_toxic_knights
				NOR = {
					has_country_flag = toxoids_7011_b
					has_country_flag = toxoids_7040_b
					has_country_flag = toxoids_7130_b
				}
			}
			has_planet_flag = toxic_knights_habitat
		}
		text = job_knight_commander_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_origin = origin_toxic_knights
				OR = {
					has_country_flag = toxoids_7011_b
					has_country_flag = toxoids_7040_b
					has_country_flag = toxoids_7130_b
				}
			}
			has_planet_flag = toxic_knights_habitat
		}
		text = job_knight_commander_research_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_origin = origin_toxic_knights
			}
			has_planet_flag = toxic_knights_habitat
		}
		text = job_knight_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				OR = {
					is_individual_machine = yes
					AND = {
						is_regular_empire = yes
						has_active_tradition = tr_synthetics_finish
					}
				}
			}
		}
		text = job_roboticist_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_authority = auth_corporate
				is_worker_coop_empire = no
			}
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		text = job_executive_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_authority = auth_corporate
				is_worker_coop_empire = yes
			}
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		text = job_steward_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_regular_empire = yes }
		}
		text = job_enforcer_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { has_valid_civic = civic_private_healthcare_corporate }
		}
		text = job_healthcare_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				is_pleasure_seeker = yes
			}
		}
		text = job_entertainer_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_machine_empire = yes }
		}
		text = job_evaluator_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_machine_empire = yes }
		}
		text = job_replicator_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_machine_empire = yes }
		}
		text = job_maintenance_drone_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_hive_empire = yes }
		}
		text = job_synapse_drone_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner.federation
			owner = {
				is_regular_empire = yes
				federation = { has_federation_perk = culture_workers_1 }
			}
		}
		text = job_culture_worker_effect_desc
	}

	upgrades = {
		"building_hab_system_capital"
	}
	
	#莉莉修改
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_origin = origin_AL_Sierlint
			}
		}
		modifier = {
			job_AL_head_majyo_add = 2
		}
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_origin = origin_AL_Sierlint
			}
		}
		text = job_AL_head_majyo_effect_desc
	}
}

# Habitat System Complex
building_hab_system_capital = {
	base_buildtime = @b3_time
	capital = yes
	can_build = no
	can_demolish = no
	can_be_ruined = no
	can_be_disabled = no
	position_priority = 0

	icon = building_system_capital

	category = government

	potential = {
		uses_habitat_capitals = yes
		exists = owner
		owner = { is_fallen_empire = no }
	}

	convert_to = {
		building_hab_fe_capital
	}

	prerequisites = {
		"tech_habitat_3"
	}

	allow = {
		OR = {
			PR_prmt_trgr_HC = { 
				MORE = 25 
			}
			num_sapient_pops >= 25
		}
	}
	resources = {
		category = planet_buildings_hab_capital
		cost = {
			minerals = @b3_minerals
		}
		upkeep = {
			energy = 5
			alloys = 5
		}
		upkeep = {
			trigger = { owner = { has_active_tradition = tr_expansion_adopt } }
			alloys = -1
		}
		inline_script = { ############ 女仆调整资源
			script = maid_buildings_change/maid_capital_building_additional_upkeep
			BASE = 3
		}
	}

	planet_modifier = {
		planet_housing_add = 8
		planet_amenities_add = 8
		planet_max_buildings_add = @buildings_t3
		planet_max_branch_office_buildings_add = 3
		defense_armies_add = @tier_4_capital_defense_armies
		pop_environment_tolerance = 0.20
	}

	inline_script = {
		script = buildings/on_all_capital_buildings
	}

	inline_script = {
		script = buildings/on_all_habitat_capital_buildings
	}

	triggered_planet_modifier = {
		modifier = { planet_stability_add = 1 }
		mult = modifier:habitat_stability_add
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_active_tradition = tr_domination_imperious_architecture
			}
		}
		modifier = {
			planet_housing_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_hive_empire = yes }
		}
		job_synapse_drone_add = 4
		planet_amenities_add = 3
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_machine_empire = yes }
		}
		job_evaluator_add = 3
		job_replicator_add = 1
		job_maintenance_drone_add = 3
		planet_amenities_add = 3
	}

	triggered_desc = {
		text = building_hab_system_capital_tooltip
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_active_tradition = tr_synthetics_finish }
		}
		job_roboticist_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_valid_civic = civic_private_healthcare_corporate }
		}
		job_healthcare_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_pleasure_seeker = yes
			}
		}
		job_entertainer_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_regular_empire = yes
				NOR = {
					has_authority = auth_corporate
					has_civic = civic_exalted_priesthood
					has_civic = civic_aristocratic_elite
					has_civic = civic_merchant_guilds
					has_civic = civic_technocracy
				}
			}
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		modifier = {
			job_politician_add = 3
		}
	}

	triggered_planet_modifier = {
		potential = {
			has_planet_flag = toxic_knights_habitat
			exists = owner
			owner = {
				has_origin = origin_toxic_knights
			}
		}
		modifier = {
			job_knight_commander_add = 1
			job_knight_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			NOT = { has_planet_flag = toxic_knights_habitat }
			exists = owner
			owner = {
				has_authority = auth_corporate
				is_worker_coop_empire = no
			}
		}
		modifier = {
			job_executive_add = 3
		}
	}

	triggered_planet_modifier = {
		potential = {
			NOT = { has_planet_flag = toxic_knights_habitat }
			exists = owner
			owner = {
				has_authority = auth_corporate
				is_worker_coop_empire = yes
			}
		}
		modifier = {
			job_steward_add = 4
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_civic = civic_exalted_priesthood }
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		modifier = {
			job_politician_add = 2
			job_high_priest_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_civic = civic_aristocratic_elite }
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		modifier = {
			job_politician_add = 2
			job_noble_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_civic = civic_technocracy }
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		modifier = {
			job_head_researcher_add = 1
			job_politician_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_civic = civic_merchant_guilds }
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		modifier = {
			job_politician_add = 2
			job_merchant_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_regular_empire = yes }
		}
		job_enforcer_add = 2
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_1 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.2
			planet_jobs_productive_produces_mult = 0.2
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner.federation
			owner = {
				is_regular_empire = yes
				federation = { has_federation_perk = culture_workers_1 }
			}
		}
		job_culture_worker_add = 1
	}

	inline_script = { ############ 女仆调整修正
		script = maid_buildings_change/maid_capital_building_jobs_and_modifiers_hab
		JOB = 3
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_civic = civic_exalted_priesthood
			}
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		text = job_high_priest_effect_desc
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_civic = civic_aristocratic_elite
			}
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		text = job_noble_effect_desc
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_civic = civic_merchant_guilds
			}
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		text = job_merchant_effect_desc
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				NOT = { has_authority = auth_corporate }
				is_regular_empire = yes
			}
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		text = job_politician_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_origin = origin_toxic_knights
				NOR = {
					has_country_flag = toxoids_7011_b
					has_country_flag = toxoids_7040_b
					has_country_flag = toxoids_7130_b
				}
			}
			has_planet_flag = toxic_knights_habitat
		}
		text = job_knight_commander_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_origin = origin_toxic_knights
				OR = {
					has_country_flag = toxoids_7011_b
					has_country_flag = toxoids_7040_b
					has_country_flag = toxoids_7130_b
				}
			}
			has_planet_flag = toxic_knights_habitat
		}
		text = job_knight_commander_research_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_origin = origin_toxic_knights
			}
			has_planet_flag = toxic_knights_habitat
		}
		text = job_knight_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { has_active_tradition = tr_synthetics_finish }
		}
		text = job_roboticist_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_authority = auth_corporate
				is_worker_coop_empire = no
			}
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		text = job_executive_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_authority = auth_corporate
				is_worker_coop_empire = yes
			}
			OR = {
				NOT = { has_planet_flag = toxic_knights_habitat }
				NOT = { owner = { has_origin = origin_toxic_knights } }
			}
		}
		text = job_steward_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_regular_empire = yes }
		}
		text = job_enforcer_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { has_valid_civic = civic_private_healthcare_corporate }
		}
		text = job_healthcare_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				is_pleasure_seeker = yes
			}
		}
		text = job_entertainer_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_machine_empire = yes }
		}
		text = job_evaluator_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_machine_empire = yes }
		}
		text = job_replicator_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_machine_empire = yes }
		}
		text = job_maintenance_drone_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_hive_empire = yes }
		}
		text = job_synapse_drone_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner.federation
			owner = {
				is_regular_empire = yes
				federation = { has_federation_perk = culture_workers_1 }
			}
		}
		text = job_culture_worker_effect_desc
	}

	upgrades = {
		building_imperial_capital
	}
}

#############
# Resort Administration
building_resort_capital = {
	capital = yes
	can_build = no
	can_demolish = no
	can_be_ruined = no
	can_be_disabled = no
	position_priority = 0

	icon = building_capital

	category = government

	potential = {
		has_modifier = resort_colony
	}

	convert_to = {
		building_hive_capital
		building_machine_capital
		building_capital
		building_ancient_control_center
		building_ancient_palace
	}

	resources = {
		category = planet_buildings
		upkeep = {
			energy = 2
		}
		inline_script = { ############ 女仆调整资源
			script = maid_buildings_change/maid_capital_building_additional_upkeep
			BASE = 1
		}
	}

	planet_modifier = {
		planet_housing_add = 5
		planet_amenities_add = 5
		job_resort_worker_add = 1
		planet_max_buildings_add = @buildings_t2
		planet_max_branch_office_buildings_add = 1
	}

	inline_script = {
		script = buildings/on_all_capital_buildings
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_active_tradition = tr_synthetics_finish }
		}
		job_roboticist_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_valid_civic = civic_private_healthcare_corporate }
		}
		job_healthcare_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				NOT = { has_authority = auth_corporate }
			}
		}
		job_politician_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_authority = auth_corporate
				is_worker_coop_empire = no
			}
		}
		modifier = {
			job_executive_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_authority = auth_corporate
				is_worker_coop_empire = yes
			}
		}
		modifier = {
			job_steward_add = 2
		}
	}

	inline_script = { ############ 女仆调整修正
		script = maid_buildings_change/maid_capital_building_jobs_and_modifiers_resort
		JOB = 1
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				NOT = { has_authority = auth_corporate }
			}
		}
		text = job_politician_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { has_active_tradition = tr_synthetics_finish }
		}
		text = job_roboticist_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				is_megacorp = yes
				is_worker_coop_empire = no
			}
		}
		text = job_executive_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				is_megacorp = yes
				is_worker_coop_empire = yes
			}
		}
		text = job_steward_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { has_valid_civic = civic_private_healthcare_corporate }
		}
		text = job_healthcare_effect_desc
	}

	triggered_desc = {
		text = job_resort_worker_effect_desc
	}

	upgrades = {
		"building_resort_major_capital"
	}
}

# Resort Governing Complex
building_resort_major_capital = {
	base_buildtime = @b2_time
	capital = yes
	can_build = no
	can_demolish = no
	can_be_ruined = no
	can_be_disabled = no
	position_priority = 0

	icon = building_major_capital

	category = government

	potential = {
		has_modifier = resort_colony
	}

	convert_to = {
		building_hive_major_capital
		building_machine_major_capital
		building_major_capital
		building_ancient_control_center
		building_ancient_palace
	}

	allow = {
		OR = {
			PR_prmt_trgr_HC = { 
				MORE = 20 
			}
			num_sapient_pops >= 20
		}
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b2_minerals
		}
		upkeep = {
			energy = @b2_upkeep
		}
		inline_script = { ############ 女仆调整资源
			script = maid_buildings_change/maid_capital_building_additional_upkeep
			BASE = 2
		}
	}

	planet_modifier = {
		planet_housing_add = 10
		planet_amenities_add = 10
		job_resort_worker_add = 2
		planet_max_buildings_add = @buildings_t3
		planet_max_branch_office_buildings_add = 2
	}

	inline_script = {
		script = buildings/on_all_capital_buildings
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_active_tradition = tr_synthetics_finish }
		}
		job_roboticist_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_valid_civic = civic_private_healthcare_corporate }
		}
		job_healthcare_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				NOT = { has_authority = auth_corporate }
			}
		}
		job_politician_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_megacorp = yes
				is_worker_coop_empire = no
			}
		}
		modifier = {
			job_executive_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_megacorp = yes
				is_worker_coop_empire = yes
			}
		}
		modifier = {
			job_steward_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_1 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.1
			planet_jobs_productive_produces_mult = 0.1
		}
	}

	inline_script = { ############ 女仆调整修正
		script = maid_buildings_change/maid_capital_building_jobs_and_modifiers_resort
		JOB = 2
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				NOT = { has_authority = auth_corporate }
			}
		}
		text = job_politician_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { has_active_tradition = tr_synthetics_finish }
		}
		text = job_roboticist_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				is_megacorp = yes
				is_worker_coop_empire = no
			}
		}
		text = job_executive_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				is_megacorp = yes
				is_worker_coop_empire = yes
			}
		}
		text = job_steward_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { has_valid_civic = civic_private_healthcare_corporate }
		}
		text = job_healthcare_effect_desc
	}

	triggered_desc = {
		text = job_resort_worker_effect_desc
	}
}

#############
#soviet mod更新后和失控女仆兼容预留，企业建筑
#############
## 正常企业建筑 ##

#私人矿业财团
building_private_mining_consortium = {
	base_buildtime = @b1_time

	owner_type = corporate

	category = resource

	potential = {
		has_branch_office = yes
		branch_office_owner = {
			is_ai = no
			is_criminal_syndicate = no
			is_socialism = no
			is_communist_country = no
			NOR = {
				has_policy_flag = tt_communist_road_3
				has_policy_flag = tt_communist_road_4
				has_policy_flag = tt_communist_road_5
				has_civic = civic_machine_servitor
			}
		}
		is_artificial = no
		NOR = {
			is_planet_class = pc_hive
			is_planet_class = pc_machine
			is_planet_class = pc_city
		}
	}

	allow = {
		NOR = {
			has_building = building_guerrilla_stronghold
			has_building = building_guerrilla_stronghold_large
		}
	}

	planet_modifier = {
		job_miner_add = 1
	}

	resources = {
		category = planet_branch_office_buildings
		cost = {
			minerals = 500
		}
		produces = {
			minerals = 10
		}
		upkeep = {
			energy = 2
		}
	}

	ai_weight = {
		factor = 1
	}
}

#快餐连锁
building_food_conglomerate = {
	base_buildtime = @b1_time

	owner_type = corporate

	category = resource

	potential = {
		has_branch_office = yes
		branch_office_owner = {
			is_ai = no
			is_criminal_syndicate = no
			is_socialism = no
			is_communist_country = no
			NOR = {
				has_policy_flag = tt_communist_road_3
				has_policy_flag = tt_communist_road_4
				has_policy_flag = tt_communist_road_5
				has_civic = civic_machine_servitor
			}
		}
		NOR = {
			is_planet_class = pc_hive
			is_planet_class = pc_machine
			is_planet_class = pc_relic
		}
	}

	allow = {
		NOR = {
			has_building = building_guerrilla_stronghold
			has_building = building_guerrilla_stronghold_large
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				OR = {
					is_anglers_empire = no
					AND = {
						is_anglers_empire = yes
						PREV = { planet = { is_wet = no } }
					}
				}
			}
		}
		modifier = {
			job_farmer_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_anglers_empire = yes
				PREV = { planet = { is_wet = yes } }
			}
		}
		modifier = {
			job_angler_add = 1
		}
	}

	resources = {
		category = planet_branch_office_buildings
		cost = {
			minerals = 500
		}
		produces = {
			food = 10
		}
		upkeep = {
			energy = 2
		}
	}

	ai_weight = {
		factor = 1
	}#AI has many other sources for this resource
}

#虚拟娱乐工作室
building_virtual_entertainment_studios = {
	base_buildtime = @b1_time

	owner_type = corporate

	category = manufacturing

	potential = {
		has_branch_office = yes
		branch_office_owner = { 
			is_criminal_syndicate = no 
			is_socialism = no
			is_communist_country = no
			NOR = {
				has_policy_flag = tt_communist_road_3
				has_policy_flag = tt_communist_road_4
				has_policy_flag = tt_communist_road_5
				has_civic = civic_machine_servitor 
			}
		}
	}

	allow = {
		NOR = {
			has_building = building_guerrilla_stronghold
			has_building = building_guerrilla_stronghold_large
		}
	}

	planet_modifier = {
		job_clerk_add = 2
	}

	resources = {
		category = planet_branch_office_buildings
		cost = {
			minerals = 500
		}
		produces = {
			consumer_goods = 6
		}
		upkeep = {
			energy = 2
		}
	}

	ai_weight = {
		weight = 3
		modifier = {
			factor = 5
			branch_office_owner = {
				has_monthly_income = {
					resource = consumer_goods
					value < 0
				}
			}
		}
		modifier = {
			factor = 0.5
			branch_office_owner = {
				has_monthly_income = {
					resource = consumer_goods
					value >= 10
				}
			}
		}
	}
}


#私人军工厂
building_private_shipyards = {
	base_buildtime = @b1_time

	owner_type = corporate

	category = manufacturing

	potential = {
		has_branch_office = yes
		branch_office_owner = {
			is_ai = no
			is_criminal_syndicate = no
			is_socialism = no
			is_communist_country = no
			NOR = {
				has_policy_flag = tt_communist_road_3
				has_policy_flag = tt_communist_road_4
				has_policy_flag = tt_communist_road_5
				has_civic = civic_machine_servitor 
			}
		}
	}

	allow = {
		NOR = {
			has_building = building_guerrilla_stronghold
			has_building = building_guerrilla_stronghold_large
		}
	}

	planet_modifier = {
		job_clerk_add = 2
	}

	resources = {
		category = planet_branch_office_buildings
		cost = {
			minerals = 500
		}
		produces = {
			alloys = 3
		}
		upkeep = {
			energy = 2
		}
	}

	ai_weight = {
		weight = 1
	}
}

#佣兵联络处
building_military_contractors = {
	base_buildtime = @b1_time

	owner_type = corporate

	category = army

	potential = {
		has_branch_office = yes
		branch_office_owner = {
			is_ai = no
			is_criminal_syndicate = no
			is_socialism = no
			is_communist_country = no
			NOR = {
				has_policy_flag = tt_communist_road_3
				has_policy_flag = tt_communist_road_4
				has_policy_flag = tt_communist_road_5
				has_civic = civic_machine_servitor 
			}
		}
	}

	allow = {
		NOR = {
			has_building = building_guerrilla_stronghold
			has_building = building_guerrilla_stronghold_large
		}
	}

	country_modifier = {
		country_naval_cap_add = 10
	}

	planet_modifier = {
		job_soldier_add = 1
		army_starting_experience_add = 100
	}

	resources = {
		category = planet_branch_office_buildings
		cost = {
			minerals = 500
		}
		upkeep = {
			energy = 2
		}
	}

	ai_weight = {
		factor = 10
	}
}

#公关公司
building_public_relations_office = {
	base_buildtime = @b2_time
	base_cap_amount = 1

	owner_type = corporate

	category = unity

	potential = {
		has_branch_office = yes
		branch_office_owner = { 
			is_criminal_syndicate = no 
			is_socialism = no
			is_communist_country = no
			NOR = {
				has_policy_flag = tt_communist_road_3
				has_policy_flag = tt_communist_road_4
				has_policy_flag = tt_communist_road_5
				has_civic = civic_machine_servitor 
			}
		}
	}

	allow = {
		NOR = {
			has_building = building_guerrilla_stronghold
			has_building = building_guerrilla_stronghold_large
		}
	}

	planet_modifier = {
		job_clerk_add = 2
	}

	resources = {
		category = planet_branch_office_buildings
		cost = {
			minerals = @b3_minerals
		}
		produces = {
			unity = 6
		}
		upkeep = {
			energy = 3
		}
	}

	ai_weight = {
		weight = 2
	}
}

#私人研究企业
building_private_research_initiative = {
	base_buildtime = @b2_time
	base_cap_amount = 1

	owner_type = corporate

	category = research

	potential = {
		has_branch_office = yes
		branch_office_owner = { 
			is_criminal_syndicate = no 
			is_socialism = no
			is_communist_country = no
			NOR = {
				has_policy_flag = tt_communist_road_3
				has_policy_flag = tt_communist_road_4
				has_policy_flag = tt_communist_road_5
				has_civic = civic_machine_servitor 
			}
		}
	}

	allow = {
		NOR = {
			has_building = building_guerrilla_stronghold
			has_building = building_guerrilla_stronghold_large
		}
	}

	planet_modifier = {
		job_clerk_add = 2
	}

	resources = {
		category = planet_branch_office_buildings
		cost = {
			minerals = @b3_minerals
		}
		produces = {
			physics_research = 6
			engineering_research = 6
			society_research = 6
		}
		upkeep = {
			energy = 3
		}
	}

	ai_weight = {
		weight = 10
	}
}

#游乐城
building_amusement_megaplex = {
	base_buildtime = @b2_time
	base_cap_amount = 1

	owner_type = corporate

	category = amenity

	potential = {
		has_branch_office = yes
		branch_office_owner = { 
			is_criminal_syndicate = no 
			is_socialism = no
			is_communist_country = no
			NOR = {
				has_origin = origin_toxic_knights
				has_policy_flag = tt_communist_road_3
				has_policy_flag = tt_communist_road_4
				has_policy_flag = tt_communist_road_5
				has_civic = civic_machine_servitor 
			}
		}
	}

	allow = {
		NOR = {
			has_building = building_guerrilla_stronghold
			has_building = building_guerrilla_stronghold_large
		}
	}

	planet_modifier = {
		planet_amenities_add = 10
	}

	resources = {
		category = planet_branch_office_buildings
		cost = {
			minerals = @b3_minerals
		}
		produces = {
			energy = 10
		}
	}

	ai_weight = {
		weight = 2

		modifier = {
			weight = 0.5
			branch_office_owner = {
				has_monthly_income = {
					resource = energy
					value > 50
				}
			}
		}
	}
}

#商业论坛
building_commercial_forum = {
	base_buildtime = @b2_time
	base_cap_amount = 1

	owner_type = corporate

	category = government

	potential = {
		has_branch_office = yes
		branch_office_owner = { 
			is_criminal_syndicate = no 
			is_socialism = no
			is_communist_country = no
			NOR = {
				has_policy_flag = tt_communist_road_3
				has_policy_flag = tt_communist_road_4
				has_policy_flag = tt_communist_road_5
				has_civic = civic_machine_servitor 
			}
		}
	}

	allow = {
		NOR = {
			has_building = building_guerrilla_stronghold
			has_building = building_guerrilla_stronghold_large
		}
	}

	planet_modifier = {
		branch_office_value_mult = 0.25
		job_merchant_add = 1
	}

	resources = {
		category = planet_branch_office_buildings
		cost = {
			minerals = @b3_minerals
		}
		upkeep = {
			energy = 3
		}
	}

	ai_weight = {
		weight = 50
	}
}

#企业大使馆
building_corporate_embassy = {
	base_buildtime = @b2_time
	base_cap_amount = 1

	owner_type = corporate

	category = government

	potential = {
		has_branch_office = yes
		branch_office_owner = { 
			is_criminal_syndicate = no 
			is_socialism = no
			is_communist_country = no
			NOR = {
				has_policy_flag = tt_communist_road_3
				has_policy_flag = tt_communist_road_4
				has_policy_flag = tt_communist_road_5
				has_civic = civic_machine_servitor 
			}
		}
	}

	allow = {
		custom_tooltip = {
			fail_text = "requires_building_major_capital"
			OR = {
				has_building = building_major_capital
				has_building = building_system_capital
				has_building = building_imperial_capital
			}
		}
		NOR = {
			has_building = building_guerrilla_stronghold
			has_building = building_guerrilla_stronghold_large
		}
	}

	prerequisites = {
		"tech_xeno_diplomacy"
	}

	show_tech_unlock_if = {
		is_megacorp = yes
		is_criminal_syndicate = no
	}

	country_modifier = {
		diplo_weight_economy_mult = 0.05
	}

	planet_modifier = {
		job_clerk_add = 2
	}

	resources = {
		category = planet_branch_office_buildings
		cost = {
			minerals = @b3_minerals
		}
		upkeep = {
			energy = 3
		}
	}

	ai_weight = {
		weight = 50
		modifier = {
			factor = 10
			branch_office_owner = {
				is_galactic_community_member = yes
			}
		}
	}
}


#############
#女仆mod的other
#############

#02_government_building
building_sentinel_posts = {
	#	|PR转化|
	exempt_from_ai_planet_specialization = yes

	base_buildtime = @b1_time

	category = government

	potential = {
		exists = owner
		owner = { 
			is_gestalt = yes 
			NOT = { has_valid_civic = civic_machine_servitor }
		}
	}

	allow = {
		hidden_trigger = {
			OR = {
				owner = { is_ai = no }
				AND = {
					NOT = { has_building = building_sentinel_posts }
					NOT = { has_forbidden_jobs = patrol_drone }
					NOT = { has_available_jobs = patrol_drone }
				}
			}
		}
	}

	destroy_trigger = {
		exists = owner
		OR = {
			owner = { 
				is_gestalt = no 
				has_valid_civic = civic_machine_servitor
			}
		}
	}

	convert_to = { #
		building_maintenance_depot
	}

	planet_modifier = {
		job_patrol_drone_add = 2
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b1_minerals
		}
		upkeep = {
			energy = 2
		}
	}

	prerequisites = {
		"tech_planetary_government"
	}

	triggered_desc = {
		text = job_patrol_drone_effect_desc
	}

	show_tech_unlock_if = {
		is_gestalt = yes
	}
}

#05_trade_building
building_commercial_zone = {
	base_buildtime = @b1_time

	exempt_from_ai_planet_specialization = yes	# |PR转化|	no
	category = trade

	potential = {
		exists = owner
		owner = { is_regular_empire = yes }
		NOT = { has_modifier = slave_colony }
		NOT = { has_building = building_low_tech_capital }
	}

	destroy_trigger = {
		exists = owner
		OR = {
			owner = { is_regular_empire = no }
			has_modifier = slave_colony
		}
	}

	convert_to = { #
		building_organic_sanctuary
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b1_minerals
		}
		upkeep = {
			energy = @b1_upkeep
		}
	}

	planet_modifier = {
		job_clerk_add = 2
		job_trader_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_active_tradition = tr_mercantile_commercial_enterprise
			}
		}
		modifier = {
			job_trader_add = 1
		}
	}

	triggered_desc = {
		text = job_clerk_effect_desc
	}

	triggered_desc = {
		text = job_trader_effect_desc
	}

	prerequisites = {
		"tech_interplanetary_commerce"
	}

	show_tech_unlock_if = {
		is_regular_empire = yes
	}

	upgrades = {
		"building_commercial_megaplex"
	}
}

building_commercial_megaplex = {
	base_buildtime = @b2_time
	can_build = no

	category = trade

	potential = {
		exists = owner
		owner = { is_regular_empire = yes }
		NOT = { has_modifier = slave_colony }
		has_building = building_commercial_zone
	}

	destroy_trigger = {
		exists = owner
		OR = {
			owner = { is_regular_empire = no }
			has_modifier = slave_colony
		}
	}
	convert_to = { #
		building_organic_paradise
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b2_minerals
			rare_crystals = @b2_rare_cost
		}
		upkeep = {
			energy = @b2_upkeep
			rare_crystals = @b2_rare_upkeep
		}
	}

	planet_modifier = {
		job_clerk_add = 4
		job_trader_add = 2
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_active_tradition = tr_mercantile_commercial_enterprise
			}
		}
		modifier = {
			job_trader_add = 2
		}
	}

	triggered_desc = {
		text = job_clerk_effect_desc
	}

	triggered_desc = {
		text = job_trader_effect_desc
	}

	prerequisites = {
		"tech_interstellar_economics"
	}

	show_tech_unlock_if = {
		is_regular_empire = yes
	}

	ai_resource_production = {
		energy = 6
		trigger = {
			OR = {
				num_unemployed >= 10
				num_assigned_jobs = {
				job = servant
					value >= 10
				}
			}
		}
	}
}

#############
#女仆mod的zz_captial
#############
# Colony
building_deployment_post = {
	capital = yes
	can_build = no
	can_demolish = no
	can_be_ruined = no
	can_be_disabled = no
	position_priority = 0

	category = government

	potential = {
		exists = owner
		owner = {
			OR = {
				is_machine_empire = yes
				is_country_type = ai_empire
			}
			is_fallen_empire = no
		}
		uses_habitat_capitals = no
		NOT = { is_planet_class = pc_cosmogenesis_world }
	}

	convert_to = {
		building_hive_capital
		building_colony_shelter
		building_ancient_control_center
		building_ancient_palace
		building_deployment_post_nanotech
	}

	planet_modifier = {
		planet_housing_add = 3
		planet_amenities_add = 8
		job_replicator_add = 2
		job_patrol_drone_add = 1
		job_maintenance_drone_add = 2
		planet_max_buildings_add = @buildings_t1
	}

	inline_script = {
		script = buildings/on_all_capital_buildings
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_civic = civic_machine_assimilator }
		}
		modifier = {
			job_replicator_add = -1
		}
	}

	triggered_planet_modifier = {
		potential = {
			has_modifier = gestation_colony
		}
		modifier = {
			job_replicator_add = -1
			job_gestation_drone_add = 2
		}
	}

	inline_script = { ############ 女仆调整修正
		script = maid_buildings_change/maid_capital_building_jobs_and_modifiers_normal
		JOB = 1
	}

	resources = {
		category = planet_buildings
		upkeep = {
			energy = 1
		}
		inline_script = { ############ 女仆调整资源
			script = maid_buildings_change/maid_capital_building_additional_upkeep
			BASE = 1
		}
	}

	upgrades = {
		building_machine_capital
	}

	triggered_desc = {
		trigger = {
			NOT = { has_modifier = gestation_colony }
		}
		text = job_replicator_effect_desc
	}

	triggered_desc = {
		trigger = {
			has_modifier = gestation_colony
		}
		text = job_gestation_drone_effect_desc
	}

	triggered_desc = {
		text = job_maintenance_drone_effect_desc
	}

	triggered_desc = {
		text = job_patrol_drone_effect_desc
	}
}

# Administrative Array
building_machine_capital = {
	base_buildtime = @b2_time
	capital = yes
	can_build = no
	can_demolish = no
	can_be_ruined = no
	can_be_disabled = no
	position_priority = 0

	category = government

	potential = {
		exists = owner
		owner = {
			OR = {
				is_machine_empire = yes
				is_country_type = ai_empire
				AND = {
					exists = event_target:mechanocalibrator_country
					is_same_value = event_target:mechanocalibrator_country
				}
			}
			is_fallen_empire = no
		}
		uses_habitat_capitals = no
		NOT = { is_planet_class = pc_cosmogenesis_world }
	}

	destroy_trigger = {
		exists = owner
		owner = { is_machine_empire = no }
	}

	convert_to = {
		building_hive_capital
		building_colony_shelter
		building_ancient_control_center
		building_ancient_palace
		building_machine_capital_nanotech
	}

	allow = {
		OR = {
			PR_prmt_trgr_HC = { 
				MORE = 10 
			}
			num_sapient_pops >= 10
		}
	}

	prerequisites = {
		"tech_planetary_government"
	}

	show_tech_unlock_if = {
		is_machine_empire = yes
	}

	planet_modifier = {
		planet_housing_add = 5
		planet_amenities_add = 10
		job_replicator_add = 2
		job_patrol_drone_add = 1
		job_maintenance_drone_add = 3
		planet_max_buildings_add = @buildings_t2
		defense_armies_add = @tier_2_capital_defense_armies
	}

	inline_script = {
		script = buildings/on_all_capital_buildings
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_civic = civic_machine_assimilator }
		}
		modifier = {
			job_replicator_add = -1
			job_maintenance_drone_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			has_modifier = gestation_colony
		}
		modifier = {
			job_replicator_add = -1
			job_gestation_drone_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_1 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.1
			planet_jobs_productive_produces_mult = 0.1
		}
	}

	inline_script = { ############ 女仆调整修正
		script = maid_buildings_change/maid_capital_building_jobs_and_modifiers_normal
		JOB = 1
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b2_minerals
		}
		upkeep = {
			energy = @b2_upkeep
		}
		inline_script = { ############ 女仆调整资源
			script = maid_buildings_change/maid_capital_building_additional_upkeep
			BASE = 1
		}
	}

	upgrades = {
		building_machine_major_capital
	}

	triggered_desc = {
		trigger = {
			NOT = { has_modifier = gestation_colony }
		}
		text = job_replicator_effect_desc
	}

	triggered_desc = {
		trigger = {
			has_modifier = gestation_colony
		}
		text = job_gestation_drone_effect_desc
	}

	triggered_desc = {
		text = job_patrol_drone_effect_desc
	}

	triggered_desc = {
		text = job_maintenance_drone_effect_desc
	}
}

# Planetary Processor
building_machine_major_capital = {
	base_buildtime = @b3_time
	capital = yes
	can_build = no
	can_demolish = no
	can_be_ruined = no
	can_be_disabled = no
	position_priority = 0

	category = government

	potential = {
		exists = owner
		owner = {
			OR = {
				is_machine_empire = yes
				is_country_type = ai_empire
			}
			is_fallen_empire = no
		}
	}

	convert_to = {
		building_hive_major_capital
		building_major_capital
		building_ancient_control_center
		building_ancient_palace
		building_machine_major_capital_nanotech
	}

	allow = {
		OR = {
			PR_prmt_trgr_HC = { 
				MORE = 25 
			}
			num_sapient_pops >= 25
		}
	}

	prerequisites = {
		"tech_colonial_centralization"
	}

	show_tech_unlock_if = {
		is_machine_empire = yes
	}

	planet_modifier = {
		planet_housing_add = 8
		planet_amenities_add = 12
		job_replicator_add = 2
		job_patrol_drone_add = 2
		job_maintenance_drone_add = 4
		planet_max_buildings_add = @buildings_t3
		defense_armies_add = @tier_3_capital_defense_armies
	}

	inline_script = {
		script = buildings/on_all_capital_buildings
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_civic = civic_machine_assimilator }
		}
		modifier = {
			job_replicator_add = -1
			job_maintenance_drone_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			has_modifier = gestation_colony
		}
		modifier = {
			job_replicator_add = -1
			job_gestation_drone_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_1 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.1
			planet_jobs_productive_produces_mult = 0.1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_2 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.1
			planet_jobs_productive_produces_mult = 0.1
		}
	}
	
	inline_script = { ############ 女仆调整修正
		script = maid_buildings_change/maid_capital_building_jobs_and_modifiers_normal
		JOB = 2
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b3_minerals
		}
		upkeep = {
			energy = @b3_upkeep
		}
		inline_script = { ############ 女仆调整资源
			script = maid_buildings_change/maid_capital_building_additional_upkeep
			BASE = 2
		}
	}

	triggered_desc = {
		trigger = {
			NOT = { has_modifier = gestation_colony }
		}
		text = job_replicator_effect_desc
	}

	triggered_desc = {
		trigger = {
			has_modifier = gestation_colony
		}
		text = job_gestation_drone_effect_desc
	}

	triggered_desc = {
		text = job_patrol_drone_effect_desc
	}

	upgrades = {
		"building_machine_system_capital"
	}
}

# Primary Nexus
building_machine_system_capital = {
	base_buildtime = @b4_time
	capital = yes
	can_build = no
	can_demolish = no
	can_be_ruined = no
	can_be_disabled = no
	position_priority = 0

	category = government

	potential = {
		exists = owner
		owner = {
			OR = {
				is_machine_empire = yes
				is_country_type = ai_empire
			}
			is_fallen_empire = no
		}
	}

	convert_to = {
		building_hive_major_capital
		building_major_capital
		building_machine_major_capital
		building_ancient_control_center
		building_ancient_palace
		building_machine_system_capital_nanotech
	}
	
	allow = {
		OR = {
			PR_prmt_trgr_HC = { 
				MORE = 50 
			}
			num_sapient_pops >= 50
		}
	}

	prerequisites = {
		"tech_galactic_administration"
	}

	show_tech_unlock_if = {
		is_machine_empire = yes
	}

	planet_modifier = {
		planet_housing_add = 12
		planet_amenities_add = 18
		job_replicator_add = 2
		job_patrol_drone_add = 3
		job_maintenance_drone_add = 5
		planet_max_buildings_add = @buildings_t4
		defense_armies_add = @tier_4_capital_defense_armies
	}

	inline_script = {
		script = buildings/on_all_capital_buildings
	}

	triggered_planet_modifier = {
		potential = {
			num_sapient_pops >= 10
		}
		modifier = {
			job_replicator_add = 1
		}
	}
	triggered_planet_modifier = {
		potential = {
			num_sapient_pops >= 40
		}
		modifier = {
			job_replicator_add = 1
		}
	}
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_civic = civic_machine_assimilator }
		}
		modifier = {
			job_replicator_add = -1
			job_maintenance_drone_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			has_modifier = gestation_colony
		}
		modifier = {
			job_replicator_add = -1
			job_gestation_drone_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_1 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.1
			planet_jobs_productive_produces_mult = 0.1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_2 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.1
			planet_jobs_productive_produces_mult = 0.1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_3 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.1
			planet_jobs_productive_produces_mult = 0.1
		}
	}

	inline_script = { ############ 女仆调整修正
		script = maid_buildings_change/maid_capital_building_jobs_and_modifiers_normal
		JOB = 3
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b4_minerals
		}
		upkeep = {
			energy = @b4_upkeep
		}
		inline_script = { ############ 女仆调整资源
			script = maid_buildings_change/maid_capital_building_additional_upkeep
			BASE = 3
		}
	}

	triggered_desc = {
		text = job_replicator_effect_desc
	}

	triggered_desc = {
		trigger = {
			has_modifier = gestation_colony
		}
		text = job_gestation_drone_effect_desc
	}

	triggered_desc = {
		text = job_patrol_drone_effect_desc
	}

	upgrades = {
		"building_imperial_machine_capital"
	}
}

# Imperial Center
building_imperial_machine_capital = {
	base_buildtime = @b4_time
	capital = yes
	can_build = no
	can_demolish = no
	can_be_ruined = no
	can_be_disabled = no
	position_priority = 0

	category = government

	potential = {
		exists = owner
		owner = {
			OR = {
				is_machine_empire = yes
				is_country_type = ai_empire
			}
			is_galactic_emperor = yes
		}
		planet = { is_capital = yes }
	}

	convert_to = {
		building_hive_major_capital
		building_machine_system_capital
		building_system_capital
		building_hab_major_capital
		building_ancient_control_center
		building_ancient_palace
	}

	allow = {
		OR = {
			PR_prmt_trgr_HC = { 
				MORE = 50 
			}
			num_sapient_pops >= 50
		}
	}

	prerequisites = {
	}

	planet_modifier = {
		planet_housing_add = 18
		planet_amenities_add = 20
		job_replicator_add = 4
		job_patrol_drone_add = 5
		job_maintenance_drone_add = 6
		planet_max_buildings_add = 11
		planet_max_branch_office_buildings_add = 3
		defense_armies_add = @tier_4_capital_defense_armies
	}

	inline_script = {
		script = buildings/on_all_capital_buildings
	}

	triggered_desc = {
		trigger = {
			has_planet_flag = habitat
		}
		text = building_hab_system_capital_tooltip
	}

	triggered_planet_modifier = {
		potential = {
			num_sapient_pops >= 10
		}
		modifier = {
			job_replicator_add = 1
		}
	}
	triggered_planet_modifier = {
		potential = {
			num_sapient_pops >= 40
		}
		modifier = {
			job_replicator_add = 1
		}
	}
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_civic = civic_machine_assimilator }
		}
		modifier = {
			job_replicator_add = -1
			job_maintenance_drone_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			has_modifier = gestation_colony
		}
		modifier = {
			job_replicator_add = -1
			job_gestation_drone_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_1 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.1
			planet_jobs_productive_produces_mult = 0.1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_2 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.1
			planet_jobs_productive_produces_mult = 0.1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_3 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.1
			planet_jobs_productive_produces_mult = 0.1
		}
	}

	inline_script = { ############ 女仆调整修正
		script = maid_buildings_change/maid_capital_building_jobs_and_modifiers_normal
		JOB = 5
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b4_minerals
		}
		upkeep = {
			energy = @b4_upkeep
		}
		inline_script = { ############ 女仆调整资源
			script = maid_buildings_change/maid_capital_building_additional_upkeep
			BASE = 5
		}
	}

	triggered_desc = {
		text = job_replicator_effect_desc
	}

	triggered_desc = {
		trigger = {
			has_modifier = gestation_colony
		}
		text = job_gestation_drone_effect_desc
	}

	triggered_desc = {
		text = job_patrol_drone_effect_desc
	}
}

##########################

# 08_unity_building
# Servitors
building_organic_sanctuary = {
	#	|PR转化|
	icon = PR_building_CULT_sanctuary_1
	exempt_from_ai_planet_specialization = yes
	
	base_buildtime = @b1_time

	category = unity

	potential = {
		exists = owner
		owner = { has_valid_civic = civic_machine_servitor }

		OR = {
			owner = { is_ai = no }
			has_upgraded_capital = yes
		}
	}

	allow = {
		custom_tooltip = { #ai不要造太多这个
			if = {
				limit = {
					owner = {
						has_valid_civic = civic_machine_servitor
						is_ai = yes
					}
				}
				OR = {
					check_variable_arithmetic = { which = value:available_bio_trophy_jobs value < 5 }
					free_amenities < 5
				}
			}
		}
	}

	destroy_trigger = {
		exists = owner
		OR = {
			owner = {
				NOT = { owner = { has_valid_civic = civic_machine_servitor } }
			}
			AND = {
				owner = { is_ai = yes }
				count_owned_pop = { limit = { has_citizenship_type = { type = citizenship_organic_trophy country = owner } } count <= 20 }
				num_buildings = { type = building_organic_sanctuary value > 3 }
			}
			AND = {
				owner = { is_ai = yes }
				count_owned_pop = { limit = { has_citizenship_type = { type = citizenship_organic_trophy country = owner } } count <= 40 }
				num_buildings = { type = building_organic_paradise value > 5 }
			}
		}
	}

	convert_to = {
		building_luxury_residence
		building_communal_housing
	}

	planet_modifier = {
		job_bio_trophy_add = 10
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b1_minerals
		}
		upkeep = {
			energy = @b1_upkeep
		}
		inline_script = { script = maid_buildings_change/maid_building_organic_sanctuary_resources } #Rogue Maid
	}

	inline_script = { script = maid_buildings_change/maid_building_organic_sanctuary_jobs_and_modifiers } #Rogue Maid

	triggered_desc = {
		text = job_bio_trophy_effect_desc
	}

	upgrades = {
		"building_organic_paradise"
	}

	# We need to cheat here and tell AI that this will probably give some complex output since AI can not evaluate what this building does without the pops which it cant get without the building - chicken and egg
	ai_resource_production = {
		unity = 10
		physics_research = 10
		alloys = 5

		trigger = {
			NOT = { has_building = building_organic_sanctuary }
		}
	}

	# Here we try to adress the second issue that the AI cant evaluate the pop job output of the bio trophy given the happiness trigger that was put inplace to guard against players exploiting bio trophies

	#science
	ai_resource_production = {
		unity = 10
		physics_research = 10

		trigger = {
			has_unemployed_pop_of_category = bio_trophy

			planet_resource_compare = {
				resource = physics_research
				value >= 100
				type = produces
			}
		}
	}

	#alloys
	ai_resource_production = {
		unity = 10
		alloys = 10

		trigger = {
			has_unemployed_pop_of_category = bio_trophy

			planet_resource_compare = {
				resource = alloys
				value >= 100
				type = produces
			}
		}
	}

	#cgs
	ai_resource_production = {
		unity = 10
		consumer_goods = 10

		trigger = {
			has_unemployed_pop_of_category = bio_trophy

			planet_resource_compare = {
				resource = consumer_goods
				value >= 100
				type = produces
			}
		}
	}
}

building_organic_paradise = {
	#	|PR转化|
	icon = PR_building_CULT_sanctuary_2
	
	base_buildtime = @b2_time
	can_build = no
	icon = building_paradise_dome

	category = unity

	potential = {
		exists = owner
		owner = { has_valid_civic = civic_machine_servitor }
	}

	destroy_trigger = {
		exists = owner
		NOT = { owner = { has_valid_civic = civic_machine_servitor } }
	}

	convert_to = {
		building_paradise_dome
		building_communal_housing_large
	}

	planet_modifier = {
		job_bio_trophy_add = 20
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b2_minerals
			exotic_gases = @b2_rare_cost
		}
		upkeep = {
			energy = @b2_upkeep
			exotic_gases = @b2_rare_upkeep
		}
		inline_script = { script = maid_buildings_change/maid_building_organic_paradise_resources } #Rogue Maid
	}

	inline_script = { script = maid_buildings_change/maid_building_organic_paradise_jobs_and_modifiers } #Rogue Maid

	triggered_desc = {
		text = job_bio_trophy_effect_desc
	}

	prerequisites = { "tech_paradise_dome" }

	show_tech_unlock_if = {
		owner = { has_valid_civic = civic_machine_servitor }
	}

	# Here we try to adress the second issue that the AI cant evaluate the pop job output of the bio trophy given the happiness trigger that was put inplace to guard against players exploiting bio trophies

	#science
	ai_resource_production = {
		unity = 20
		physics_research = 20

		trigger = {
			has_unemployed_pop_of_category = bio_trophy

			planet_resource_compare = {
				resource = physics_research
				value >= 100
				type = produces
			}
		}
	}

	#alloys
	ai_resource_production = {
		unity = 20
		alloys = 20

		trigger = {
			has_unemployed_pop_of_category = bio_trophy

			planet_resource_compare = {
				resource = alloys
				value >= 100
				type = produces
			}
		}
	}

	#cgs
	ai_resource_production = {
		unity = 20
		consumer_goods = 20

		trigger = {
			has_unemployed_pop_of_category = bio_trophy

			planet_resource_compare = {
				resource = consumer_goods
				value >= 100
				type = produces
			}
		}
	}
}

# 13_fallen_empire_builging
building_fe_dome = {
	base_buildtime = @b2_time
	can_build = no

	category = amenity

	potential = {
		exists = owner
		owner = {
			OR = {
				is_fallen_empire = yes
				has_technology = tech_fe_dome_2
				has_country_flag = skydome_can_build
			}
		}
		NOT = {
			has_modifier = slave_colony
		}
	}

	allow = {
		custom_tooltip = {
			fail_text = ancrel.10004.failtext
			exists = owner
			owner = {
				OR = {
					check_variable = { which = skydome_upgrade_count value >= 1 }
					is_fallen_empire = yes
					has_technology = tech_fe_dome_2
				}
			}
		}
	}

	destroy_trigger = {
		always = no
	}

	planet_modifier = {
		planet_housing_add = 50
		planet_amenities_add = 50
		planet_pops_upkeep_mult = -0.05
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_valid_civic = civic_machine_servitor
			}
		}
		job_bio_trophy_add = 50
	}

	resources = {
		category = planet_buildings
		cost = {
			alloys = @b2_minerals
		}
		upkeep = {
			alloys = @b1_alloy_upkeep
			energy = 10
		}
		inline_script = { script = maid_buildings_change/maid_building_fe_dome_resources } #Rogue Maid
	}

	inline_script = { script = maid_buildings_change/maid_building_fe_dome_jobs_and_modifiers } #Rogue Maid


	on_queued = {
		owner = {
			subtract_variable = { which = skydome_upgrade_count value = 1 }
		}
	}

	on_unqueued = {
		owner = {
			change_variable = { which = skydome_upgrade_count value = 1 }
		}
	}

	show_in_tech = tech_fe_dome_2
}

holding_organic_sanctuary = {
	base_buildtime = @b2_time
	owner_type = subject_holding
	icon = building_organic_sanctuary
	base_cap_amount = 1

	category = unity

	resources = {
		category = planet_holdings
		upkeep = {
			consumer_goods = 10
		}
	}

	potential = {
		owner.overlord = { has_valid_civic = civic_machine_servitor }
		owner = { is_machine_empire = no }
	}

	triggered_planet_modifier = {
		potential = {
			exists = planet.owner
			planet.owner = { is_gestalt = no }
		}
		job_overlord_bio_trophy_add = 5
		job_overlord_bio_trophy_maid_add = 5
		monthly_loyalty = 0.5
	}
	triggered_planet_modifier = {
		potential = {
			exists = planet.owner
			planet.owner = { is_gestalt = yes }
		}
		job_overlord_bio_trophy_drone_add = 5
		job_overlord_bio_trophy_drone_maid_add = 5
	}
	triggered_desc = {
		text = job_overlord_bio_trophy_effect_desc
	}
}

building_clinic = {
	#	|PR转化|
	exempt_from_ai_planet_specialization = yes

	base_buildtime = @b1_time
	base_cap_amount = 1

	category = amenity

	potential = {
		exists = owner
		# rule out Thrall-Worlds
		NOT = { has_modifier = slave_colony }
		# check the empire is valid
		owner = {
			# rule out gestalts and pre-FTL societies
			is_individual_machine = no
			OR = {
				is_regular_empire = yes
				AND = {
					has_origin = origin_fear_of_the_dark
					is_country_type = primitive
				}
				has_valid_civic = civic_machine_servitor
				has_valid_civic = civic_machine_healthcare
			}
			# rule out AI empires with entirely no access to "Pharma State" Civic, unless the planet is unstable
			OR = {
				is_ai = no
				has_valid_civic = civic_private_healthcare_corporate
				prev = {
					has_branch_office = yes
					branch_office_owner = {
						has_valid_civic = civic_private_healthcare_corporate
					}
				}
				prev = {
					NOT = { has_available_jobs = entertainer }
					NOT = { has_forbidden_jobs = entertainer }
					planet_stability < 50
					free_amenities < 0
				}
			}
		}
	}

	destroy_trigger = {
		OR = {
			# if this is now a Thrall-World
			has_modifier = slave_colony
			# if the planet is owned by a gestalt or pre-FTL society
			AND = {
				exists = owner
				owner = {
					NOR = {
						is_regular_empire = yes
						AND = {
							has_origin = origin_fear_of_the_dark
							is_country_type = primitive
						}
						has_valid_civic = civic_machine_servitor
						has_valid_civic = civic_machine_healthcare
						############
                        ####莉莉修改
                        ############
                        NOT = {
							has_origin = origin_AL_irma
						}
					}
				}
			}
			# if this is an AI-controlled empire with entirely no access to "Pharma State" Civic, assuming the planet is now stable
			AND = {
				exists = owner
				owner = {
					is_ai = yes
					NOT = {
						OR = {
							has_valid_civic = civic_private_healthcare_corporate
							prev = {
								has_branch_office = yes
								branch_office_owner = {
									has_valid_civic = civic_private_healthcare_corporate
								}
							}
						}
					}
				}
				planet_stability > 70
				free_amenities > 20
			}
		}
	}
	############
    ####莉莉修改
    ############
    #伊尔马转换
    convert_to = {
        building_irma_pop
    }

	planet_modifier = {
		job_healthcare_add = 2
	}
	
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_technology = tech_gene_tailoring
			}
			any_owned_pop = {
				has_auto_modding_trait = yes
			}
		}
		modifier = {
			auto_mod_monthly_add = 1
		}
	}
	
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_origin = origin_overtuned
			}
			any_owned_pop = {
				has_auto_modding_trait = yes
			}
		}
		modifier = {
			auto_mod_monthly_add = 1
		}
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b1_minerals
		}
		upkeep = {
			energy = @b1_upkeep
		}
	}

	prerequisites = {
		"tech_frontier_health"
	}

	upgrades = {
		"building_hospital"
	}

	triggered_planet_modifier = { #
		potential = {
			exists = owner
			owner = { is_regular_empire = yes }
		}
		job_healthcare_add = 2
	}
	triggered_planet_modifier = { #
		potential = {
			exists = owner
			owner = { is_gestalt = yes }
		}
		modifier = {
			planet_healthcaring_drones_amenities_produces_mult = 0.25 #没有实际效果，实际效果写在pop_jobs中
			planet_doctors_upkeep_mult = 0.25
			job_healthcaring_drone_add = 2
		}
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_regular_empire = yes }
		}
		text = job_healthcare_effect_desc
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_gestalt = yes }
		}
		text = job_healthcaring_drone_effect_desc
	}

	on_destroy = {
		owner = {
			if = {
				limit = {
					has_event_chain = payback_out_of_warranty_chain
				}
				end_event_chain = payback_out_of_warranty_chain
			}
		}
	}

	on_repaired = {
		if = {
			limit = {
				planet.owner = {
					has_event_chain = payback_out_of_warranty_chain
				}
			}
			random_list = {
				50 = { # still broken
					planet.owner = {
						country_event = { id = origin.4302 }
					}
					modifier = {
						factor = 0
						planet.owner = { has_technology = tech_frontier_health }
					}
				}
				20 = { # repaired
					planet.owner = {
						country_event = { id = origin.4301 }
					}
					modifier = {
						factor = 2
						planet.owner = { num_research_agreements = 1 }
					}
					modifier = {
						factor = 3
						planet.owner = { num_research_agreements = 2 }
					}
					modifier = {
						factor = 4
						planet.owner = { num_research_agreements >= 3 }
					}
				}
				10 = { # broken beyond repair
					planet = {
						planet_event = { id = origin.4303 }
					}
				}
			}
		}
	}
}

building_hospital = {
	base_buildtime = @b2_time
	can_build = no

	category = amenity

	potential = {
		has_building = building_clinic
	}

	allow = {
		has_upgraded_capital = yes
		OR = {
			owner = {
				OR = {
					has_valid_civic = civic_private_healthcare_corporate
					is_ai = no
				}
			}
			AND = {
				NOT = { has_available_jobs = entertainer }
				NOT = { has_forbidden_jobs = entertainer }
				planet_stability < 55
				free_amenities < 5
			}
			AND = {
				has_branch_office = yes
				branch_office_owner = {
					has_valid_civic = civic_private_healthcare_corporate
				}
			}
		}
		if = {  #女仆非必要不准建造这个
			limit = {
				exists = owner
				owner = {
					is_ai = yes
					has_civic = civic_machine_servitor
				}
			}
			OR = {
				free_amenities < -6
				count_owned_pop = {
					limit = {
						prev = {
							habitability = {
								who = prev
								value < 40
							}
						}
					}
					count > 5
				}
			}
		}
	}

	destroy_trigger = {
		exists = owner
		OR = {
			owner = {
				is_gestalt = yes
				NOR = {
					has_valid_civic = civic_machine_servitor
					has_valid_civic = civic_machine_healthcare
				}
			}
			has_modifier = slave_colony
			AND = {
				buildings_stop_pop = yes
				owner = { is_ai = yes }
			}
		}
	}

	planet_modifier = {
		job_healthcare_add = @b2_jobs
	}
	
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_technology = tech_gene_tailoring
			}
			any_owned_pop = {
				has_auto_modding_trait = yes
			}
		}
		modifier = {
			auto_mod_monthly_add = 2
		}
	}
	
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_origin = origin_overtuned
			}
			any_owned_pop = {
				has_auto_modding_trait = yes
			}
		}
		modifier = {
			auto_mod_monthly_add = 2
		}
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b2_minerals
			exotic_gases = @b2_rare_cost
		}
		upkeep = {
			energy = @b2_upkeep
			exotic_gases = @b2_rare_upkeep
		}
	}

	prerequisites = {
		"tech_frontier_hospital"
	}

	show_tech_unlock_if = {
		OR ={
			is_regular_empire = yes
			has_valid_civic = civic_machine_servitor
			has_valid_civic = civic_machine_healthcare
		}
	}

	triggered_planet_modifier = { #
		potential = {
			exists = owner
			owner = { is_regular_empire = yes }
		}
		job_healthcare_add = 4
	}
	triggered_planet_modifier = { #
		potential = {
			exists = owner
			owner = { is_gestalt = yes }
		}
		modifier = {
			planet_healthcaring_drones_amenities_produces_mult = 0.5 #没有实际效果，实际效果写在pop_jobs中
			planet_doctors_upkeep_mult = 0.5
			job_healthcaring_drone_add = 2
		}
	}
	triggered_planet_modifier = { #
		potential = {
			exists = owner
			owner = {
				is_servitor_empire = no
				has_valid_civic = civic_machine_healthcare
			}
		}
		modifier = { job_healthcaring_drone_add = 2 }
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_regular_empire = yes }
		}
		text = job_healthcare_effect_desc
	}
}

building_ancient_cryo_chamber = {
	base_buildtime = @b2_time
	can_build = no
	can_demolish = yes

	category = government

	potential = {
	}

	country_modifier = {
		category_biology_research_speed_mult = 0.1
	}

	triggered_country_modifier = {
		potential = {
			exists = owner
			owner = {
				is_fallen_empire = no
			}
		}
		BIOLOGICAL_species_trait_points_add = 1
		Magical_Bitch_species_trait_points_add = 1
		PARASITE_species_trait_points_add = 1
		Magical_Girl_trait_points_add = 1
		MONSTER_species_trait_points_add = 1
		TENTACLE_species_trait_points_add = 1
		Lust_Girl_species_trait_points_add = 1
		Erotic_Creation_species_trait_points_add = 1
		NYTO_species_trait_points_add = 1
		EILD_species_trait_points_add = 1
		WARSHIPGIRL_species_trait_points_add = 1
		SHENHAI_species_trait_points_add = 1
		UNITED_FLEET_species_trait_points_add = 1
		LILY_species_trait_points_add = 1
		STARSHIPGIRLS_species_trait_points_add = 1
		Dolls_species_trait_points_add = 1
		TOUHOUGIRLS_species_trait_points_add = 1
		BIOLOGICAL_species_trait_picks_add = 1
		Magical_Bitch_species_trait_picks_add = 1
		PARASITE_trait_picks_add = 1
		Magical_Girl_trait_picks_add = 1
		MONSTER_species_trait_picks_add = 1
		TENTACLE_species_trait_picks_add = 1
		Lust_Girl_species_trait_picks_add = 1
		Erotic_Creation_species_trait_picks_add = 1
		NYTO_species_trait_picks_add = 1
		EILD_species_trait_picks_add = 1
		WARSHIPGIRL_species_trait_picks_add = 1
		SHENHAI_species_trait_picks_add = 1
		UNITED_FLEET_species_trait_picks_add = 1
		LILY_species_trait_picks_add = 1
		STARSHIPGIRLS_species_trait_picks_add = 1
		Dolls_species_trait_picks_add = 1
		TOUHOUGIRLS_species_trait_picks_add = 1
	}

	resources = {
		category = planet_buildings
		cost = {
			alloys = @b2_minerals
		}
		upkeep = {
			sr_living_metal = 1
			energy = 50
		}
	}

	upgrades = {
		building_repair_the_ancient_cryo_chamber
	}

	triggered_desc = {
		trigger = { owner = { has_valid_civic = civic_machine_servitor } }
		text = building_ancient_cryo_chamber_effect_desc
	}
}

building_repair_the_ancient_cryo_chamber = {
	base_buildtime = @b1_time
	icon = building_repaired_cryo_chamber
	can_build = no
	
	category = government

	potential = {
		owner = { has_valid_civic = civic_machine_servitor }
	}
	allow = {
		has_upgraded_capital = yes
	}

	country_modifier = {
		category_biology_research_speed_mult = 0.2
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b1_minerals
			exotic_gases = @b2_rare_cost
		}
		upkeep = {
			energy = @b3_upkeep
			exotic_gases = @b3_rare_upkeep
		}
	}

	triggered_country_modifier = {
		potential = {
			exists = owner
			owner = {
				is_fallen_empire = no
			}
		}
		BIOLOGICAL_species_trait_points_add = 2
		Magical_Bitch_species_trait_points_add = 2
		PARASITE_species_trait_points_add = 2
		Magical_Girl_trait_points_add = 2
		MONSTER_species_trait_points_add = 2
		TENTACLE_species_trait_points_add = 2
		Lust_Girl_species_trait_points_add = 2
		Erotic_Creation_species_trait_points_add = 2
		NYTO_species_trait_points_add = 2
		EILD_species_trait_points_add = 2
		WARSHIPGIRL_species_trait_points_add = 2
		SHENHAI_species_trait_points_add = 2
		UNITED_FLEET_species_trait_points_add = 2
		LILY_species_trait_points_add = 2
		STARSHIPGIRLS_species_trait_points_add = 2
		Dolls_species_trait_points_add = 2
		TOUHOUGIRLS_species_trait_points_add = 2
		BIOLOGICAL_species_trait_picks_add = 2
		Magical_Bitch_species_trait_picks_add = 2
		PARASITE_trait_picks_add = 2
		Magical_Girl_trait_picks_add = 2
		MONSTER_species_trait_picks_add = 2
		TENTACLE_species_trait_picks_add = 2
		Lust_Girl_species_trait_picks_add = 2
		Erotic_Creation_species_trait_picks_add = 2
		NYTO_species_trait_picks_add = 2
		EILD_species_trait_picks_add = 2
		WARSHIPGIRL_species_trait_picks_add = 2
		SHENHAI_species_trait_picks_add = 2
		UNITED_FLEET_species_trait_picks_add = 2
		LILY_species_trait_picks_add = 2
		STARSHIPGIRLS_species_trait_picks_add = 2
		Dolls_species_trait_picks_add = 2
		TOUHOUGIRLS_species_trait_picks_add = 2
	}

	triggered_desc = {
		text = job_hibernation_effect_desc
	}
}

holding_toxic_bath_machine = {
	base_buildtime = @b1_time
	owner_type = subject_holding
	icon = building_toxic_bath_machine
	base_cap_amount = 1

	category = amenity

	resources = {
		category = planet_holdings
		cost = {
			minerals = @b1_minerals
		}
		upkeep = {
			minerals = @b2_upkeep
		}
	}

	potential = {
		owner.overlord = { has_toxic_baths = yes }
		owner = { has_authority = auth_machine_intelligence }
	}

	destroy_trigger = {
		owner.overlord = { has_toxic_baths = no }
	}

	triggered_planet_modifier = {
		potential = {
			exists = planet.owner
			planet.owner = { has_valid_civic = civic_environmentalist }
		}
		monthly_loyalty = -0.5
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_authority = auth_machine_intelligence }
		}
		job_overlord_bath_attendant_machine_add = 2
	}

	triggered_desc = {
		trigger = {
			exists = planet.owner
			planet.owner = { has_authority = auth_machine_intelligence }
		}
		text = job_overlord_toxic_baths_effect_machine_desc
	}
}

##########################
# Machine Empire Memorial
##########################
# 08_unity_building

building_simulation_1 = {
	#	|PR转化|
	icon = PR_building_CULT_core_MACHINE_1
	exempt_from_ai_planet_specialization = yes

	base_buildtime = @b1_time
	base_cap_amount = 1
	icon = building_holo_theatres

	category = unity

	potential = {
		exists = owner
		NOT = { has_modifier = slave_colony }
		owner = {
			is_machine_empire = yes
			is_memorialist_empire = no
		}
	}

	destroy_trigger = {
		exists = owner
		OR = {
			has_modifier = slave_colony
			owner = {
				OR = {
					is_machine_empire = no
					is_memorialist_empire = yes
				}
			}
		}
	}

	resources = {
		category = planet_buildings
		produces = {
			trigger = { exists = owner }
			unity = 1
			multiplier = owner.trigger:num_ascension_perks
		}
		cost = {
			minerals = @b1_minerals
		}
	}

	planet_modifier = {
		planet_jobs_unity_produces_mult = 0.05
		job_evaluator_add = @b1_jobs
	}

	inline_script = { #Rogue Maid
		script = maid_buildings_change/maid_building_simulation_jobs
		JOB = 2
	}

	triggered_desc = {
		text = building_autochthon_monument_effect
	}

	triggered_desc = {
		text = job_evaluator_effect_desc
	}

	prerequisites = {
		"tech_cultural_heritage"
	}

	convert_to = {
		building_autochthon_monument
		building_corporate_monument
		building_galactic_memorial_1
		building_sensorium_1
	}

	show_tech_unlock_if = {
		is_machine_empire = yes
		is_memorialist_empire = no
	}

	upgrades = {
		building_simulation_2
	}
}

building_simulation_2 = {
	#	|PR转化|
	icon = PR_building_CULT_core_MACHINE_2
	
	base_buildtime = @b2_time
	can_build = no
	icon = building_hyper_entertainment_forum

	category = unity

	potential = {
		exists = owner
		NOT = { has_modifier = slave_colony }
		owner = {
			is_machine_empire = yes
			is_memorialist_empire = no
		}
	}

	allow = {
		has_upgraded_capital = yes
	}

	destroy_trigger = {
		exists = owner
		OR = {
			has_modifier = slave_colony
			owner = {
				OR = {
					is_machine_empire = no
					is_memorialist_empire = yes
				}
			}
		}
	}

	convert_to = {
		building_corporate_site
		building_heritage_site
		building_galactic_memorial_2
		building_sensorium_2
	}

	resources = {
		category = planet_buildings
		produces = {
			trigger = { exists = owner }
			unity = 2
			multiplier = owner.trigger:num_ascension_perks
		}
		cost = {
			minerals = @b2_minerals
		}
	}

	planet_modifier = {
		planet_jobs_unity_produces_mult = 0.10
		job_evaluator_add = @b2_jobs
	}

	inline_script = { #Rogue Maid
		script = maid_buildings_change/maid_building_simulation_jobs
		JOB = 4
	}

	triggered_desc = {
		text = building_heritage_site_effect
	}

	triggered_desc = {
		text = job_evaluator_effect_desc
	}

	prerequisites = {
		"tech_heritage_site"
	}

	show_tech_unlock_if = {
		is_machine_empire = yes
		is_memorialist_empire = no
	}

	upgrades = {
		building_simulation_3
	}
}

building_simulation_3 = {
	#	|PR转化|
	icon = PR_building_CULT_core_MACHINE_3

	base_buildtime = @b3_time
	can_build = no
	icon = building_citadel_of_faith

	category = unity

	potential = {
		exists = owner
		NOT = { has_modifier = slave_colony }
		owner = {
			is_machine_empire = yes
			is_memorialist_empire = no
		}
	}

	allow = {
		has_major_upgraded_capital = yes
	}

	destroy_trigger = {
		exists = owner
		OR = {
			has_modifier = slave_colony
			owner = {
				OR = {
					is_machine_empire = no
					is_memorialist_empire = yes
				}
			}
		}
	}

	convert_to = {
		building_corporate_forum
		building_hypercomms_forum
		building_galactic_memorial_3
		building_sensorium_3
	}

	resources = {
		category = planet_buildings
		produces = {
			trigger = { exists = owner }
			unity = 3
			multiplier = owner.trigger:num_ascension_perks
		}
		cost = {
			minerals = @b3_minerals
		}
	}

	planet_modifier = {
		planet_jobs_unity_produces_mult = 0.15
		job_evaluator_add = @b3_jobs
	}

	inline_script = { #Rogue Maid
		script = maid_buildings_change/maid_building_simulation_jobs
		JOB = 6
	}

	triggered_desc = {
		text = building_hypercomms_forum_effect
	}


	triggered_desc = {
		text = job_evaluator_effect_desc
	}

	prerequisites = {
		"tech_hypercomms_forum"
	}

	show_tech_unlock_if = {
		is_machine_empire = yes
		is_memorialist_empire = no
	}
}

##################
# Memorialists
##################

#Sanctuary of Repose
building_galactic_memorial_1 = {
	#	|PR转化|
	icon = PR_building_CULT_core_MEMORIALIST_1

	exempt_from_ai_planet_specialization = yes

	base_buildtime = @b1_time
	base_cap_amount = 1
	category = unity

	potential = {
		exists = owner
		NOT = { has_modifier = slave_colony }
		owner = {
			is_memorialist_empire = yes
		}
	}

	destroy_trigger = {
		exists = owner
		OR = {
			has_modifier = slave_colony
			owner = {
				is_memorialist_empire = no
			}
		}
	}

	convert_to = {
		building_autochthon_monument
		building_corporate_monument
		building_simulation_1
		building_sensorium_1
	}

	resources = {
		category = planet_buildings
		produces = {
			trigger = { exists = owner }
			unity = 1
			multiplier = owner.trigger:num_ascension_perks
		}
		cost = {
			minerals = @b1_minerals
		}
		upkeep = {
			minerals = @b1_upkeep
		}
	}

	planet_modifier = {
		planet_jobs_unity_produces_mult = 0.05
	}

	triggered_desc = {
		text = building_autochthon_monument_effect
	}

	prerequisites = {
		"tech_cultural_heritage"
	}

	#Jobs
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_gestalt = no }
		}
		job_death_chronicler_add = @b1_jobs
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_gestalt = no }
		}
		text = "job_death_chronicler_effect_desc"
	}
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_gestalt = yes }
		}
		job_chronicle_drone_add = @b1_jobs
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_gestalt = yes }
		}
		text = "job_chronicle_drone_effect_desc"
	}

	inline_script = { #Rogue Maid
		script = maid_buildings_change/maid_building_galactic_memorial_jobs
		JOB = 2
	}

	#Tomb/Relic worlds
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_gestalt = no }
			OR = {
				is_planet_class = pc_nuked
				is_planet_class = pc_relic
			}
		}
		pop_government_ethic_attraction = 0.20
	}
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_gestalt = yes }
			OR = {
				is_planet_class = pc_nuked
				is_planet_class = pc_relic
			}
		}
		planet_crime_no_happiness_add = -20
	}

	upgrades = {
		building_galactic_memorial_2
	}

	show_tech_unlock_if = {
		is_memorialist_empire = yes
	}
}

#Pillar of Quietus
building_galactic_memorial_2 = {
	#	|PR转化|
	icon = PR_building_CULT_core_MEMORIALIST_2

	base_buildtime = @b2_time
	can_build = no
	category = unity

	potential = {
		exists = owner
		NOT = { has_modifier = slave_colony }
		owner = {
			is_memorialist_empire = yes
		}
	}

	allow = {
		exists = owner
		has_upgraded_capital = yes
	}

	destroy_trigger = {
		exists = owner
		OR = {
			has_modifier = slave_colony
			owner = {
				is_memorialist_empire = no
			}
		}
	}

	convert_to = {
		building_heritage_site
		building_corporate_site
		building_simulation_2
		building_sensorium_2
	}

	resources = {
		category = planet_buildings
		produces = {
			trigger = { exists = owner }
			unity = 2
			multiplier = owner.trigger:num_ascension_perks
		}
		cost = {
			minerals = @b2_minerals
			exotic_gases = @b2_rare_cost
		}
		upkeep = {
			minerals = @b2_upkeep
			exotic_gases = @b2_rare_upkeep
		}
	}

	planet_modifier = {
		planet_jobs_unity_produces_mult = 0.10
	}

	triggered_desc = {
		text = building_heritage_site_effect
	}

	prerequisites = {
		"tech_heritage_site"
	}

	#Jobs
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_gestalt = no }
		}
		job_death_chronicler_add = @b2_jobs
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_gestalt = no }
		}
		text = "job_death_chronicler_effect_desc"
	}
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_gestalt = yes }
		}
		job_chronicle_drone_add = @b2_jobs
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_gestalt = yes }
		}
		text = "job_chronicle_drone_effect_desc"
	}

	inline_script = { #Rogue Maid
		script = maid_buildings_change/maid_building_galactic_memorial_jobs
		JOB = 4
	}

	#Tomb/Relic worlds
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_gestalt = no }
			OR = {
				is_planet_class = pc_nuked
				is_planet_class = pc_relic
			}
		}
		pop_government_ethic_attraction = 0.20
	}
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_gestalt = yes }
			OR = {
				is_planet_class = pc_nuked
				is_planet_class = pc_relic
			}
		}
		planet_crime_no_happiness_add = -20
	}

	upgrades = {
		building_galactic_memorial_3
	}

	show_tech_unlock_if = {
		is_memorialist_empire = yes
	 }
}

#Galactic Memorial
building_galactic_memorial_3 = {
	#	|PR转化|
	icon = PR_building_CULT_core_MEMORIALIST_3

	base_buildtime = @b3_time
	can_build = no
	category = unity

	potential = {
		exists = owner
		NOT = { has_modifier = slave_colony }
		owner = {
			is_memorialist_empire = yes
		}
	}

	allow = {
		has_major_upgraded_capital = yes
	}

	destroy_trigger = {
		exists = owner
		OR = {
			has_modifier = slave_colony
			owner = { is_memorialist_empire = no }
		}
	}

	convert_to = {
		building_hypercomms_forum
		building_corporate_forum
		building_simulation_3
		building_sensorium_3
	}

	resources = {
		category = planet_buildings
		produces = {
			trigger = { exists = owner }
			unity = 3
			multiplier = owner.trigger:num_ascension_perks
		}
		cost = {
			minerals = @b3_minerals
			exotic_gases = @b3_rare_cost
		}
		upkeep = {
			minerals = @b3_upkeep
			exotic_gases = @b3_rare_upkeep
		}
	}

	planet_modifier = {
		planet_jobs_unity_produces_mult = 0.15
	}

	triggered_desc = {
		text = building_hypercomms_forum_effect
	}

	prerequisites = {
		"tech_hypercomms_forum"
	}

	#Jobs
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_gestalt = no }
		}
		job_death_chronicler_add = @b3_jobs
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_gestalt = no }
		}
		text = "job_death_chronicler_effect_desc"
	}
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_gestalt = yes }
		}
		job_chronicle_drone_add = @b3_jobs
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_gestalt = yes }
		}
		text = "job_chronicle_drone_effect_desc"
	}

	inline_script = { #Rogue Maid
		script = maid_buildings_change/maid_building_galactic_memorial_jobs
		JOB = 6
	}

	#Tomb/Relic worlds
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_gestalt = no }
			OR = {
				is_planet_class = pc_nuked
				is_planet_class = pc_relic
			}
		}
		pop_government_ethic_attraction = 0.20
	}
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_gestalt = yes }
			OR = {
				is_planet_class = pc_nuked
				is_planet_class = pc_relic
			}
		}
		planet_crime_no_happiness_add = -20
	}

	show_tech_unlock_if = {
		is_memorialist_empire = yes
	}
}

building_gaiaseeders_1 = {
	base_buildtime = @b2_time
	base_cap_amount = 1
	category = government
	can_be_disabled = no
	upgrades = { "building_gaiaseeders_2" }

	potential = {
		exists = owner
		owner = {
			OR = {
				is_country_type = default
				is_zofe_compatible = yes
			}
			is_idyllic_bloom_empire = yes
		}
		NOR = {
			is_planet_class = pc_gaia
			is_planet_class = pc_city
			is_planet_class = pc_hive
			is_planet_class = pc_machine
			is_planet_class = pc_relic
		}
		is_artificial = no
		if = {
			limit = { has_global_flag = planetarydiversity }
			is_pd_gaia = no
			is_pd_hive_world = no
			is_pd_machine = no
			is_pd_aquatics = no
			#is_artificial = no
			is_pd_habitat = no
			is_pd_unique = no
			is_pd_arcology = no
			is_pd_shroud_world = no
		}
	}

	allow = {
		has_upgraded_capital = yes
	}

	destroy_trigger = {
		OR = {
			is_planet_class = pc_gaia	# No double bonuses if player uses other tools to turn it into a Gaia world.
			is_planet_class = pc_city
			is_planet_class = pc_hive
			is_planet_class = pc_machine
			is_planet_class = pc_relic
			NOT = { exists = owner }
			owner = {
				is_idyllic_bloom_empire = no
			}
		}
		AND = {
			has_global_flag = planetarydiversity
			OR = {
				is_pd_gaia = yes
				is_planet_class = pc_city
				is_pd_hive_world = yes
				is_pd_machine = yes
				is_planet_class = pc_relic
				is_planet_class = pc_nuked_relic
			}
		}
	}

	resources = {
		category = planet_buildings
		cost = {
			energy = 1500
		}
		upkeep = {
			trigger = {
				exists = owner
				owner = { is_machine_empire = no }
			}
			energy = 20
			multiplier = value:gaiaseeder_upkeep
		}
		upkeep = {
			trigger = {
				exists = owner
				owner = { is_machine_empire = yes }
			}
			energy = 20
			multiplier = value:gaiaseeder_upkeep_machine
		}
	}

	planet_modifier = {
		pop_growth_speed = 0.1
	}
}

building_gaiaseeders_2 = {
	base_buildtime = @b2_time
	can_build = no
	category = government
	can_be_disabled = no
	upgrades = { "building_gaiaseeders_3" }

	resources = {
		category = planet_buildings
		cost = {
			energy = 1500
			exotic_gases = @b2_rare_cost
		}
		upkeep = {
			trigger = {
				exists = owner
				owner = { is_machine_empire = no }
			}
			energy = 20
			exotic_gases = @b2_rare_upkeep
			multiplier = value:gaiaseeder_upkeep
		}
		upkeep = {
			trigger = {
				exists = owner
				owner = { is_machine_empire = yes }
			}
			energy = 20
			exotic_gases = @b2_rare_upkeep
			multiplier = value:gaiaseeder_upkeep_machine
		}
	}

	destroy_trigger = {
		OR = {
			is_planet_class = pc_gaia
			is_planet_class = pc_city
			is_planet_class = pc_hive
			is_planet_class = pc_machine
			NOT = { exists = owner }
			owner = {
				is_idyllic_bloom_empire = no
			}
			AND = {
				has_global_flag = planetarydiversity
				OR = {
					is_pd_gaia = yes
					is_planet_class = pc_city
					is_pd_hive_world = yes
					is_pd_machine = yes
					is_planet_class = pc_relic
					is_planet_class = pc_nuked_relic
				}
			}
		}
	}

	allow = {
		if = {
			limit = { owner = { is_machine_empire = no } }
			can_build_gaiaseeder = yes
		}
		else = {
			can_build_gaiaseeder_machine = yes
		}
	}

	planet_modifier = {
		pop_growth_speed = 0.05
		pop_environment_tolerance = 0.1
	}
}

building_gaiaseeders_3 = {
	base_buildtime = @b2_time
	can_build = no
	category = government
	can_be_disabled = no
	upgrades = { "building_gaiaseeders_4" }

	resources = {
		category = planet_buildings
		cost = {
			energy = 1500
			exotic_gases = @b3_rare_cost
		}
		upkeep = {
			trigger = {
				exists = owner
				owner = { is_machine_empire = no }
			}
			energy = 20
			exotic_gases = @b3_rare_upkeep
			multiplier = value:gaiaseeder_upkeep
		}
		upkeep = {
			trigger = {
				exists = owner
				owner = { is_machine_empire = yes }
			}
			energy = 20
			exotic_gases = @b3_rare_upkeep
			multiplier = value:gaiaseeder_upkeep_machine
		}
	}

	destroy_trigger = {
		OR = {
			is_planet_class = pc_gaia
			is_planet_class = pc_city
			is_planet_class = pc_hive
			is_planet_class = pc_machine
			NOT = { exists = owner }
			owner = {
				is_idyllic_bloom_empire = no
			}
		}
		AND = {
			has_global_flag = planetarydiversity
			OR = {
				is_pd_gaia = yes
				is_planet_class = pc_city
				is_pd_hive_world = yes
				is_pd_machine = yes
				is_planet_class = pc_relic
				is_planet_class = pc_nuked_relic
			}
		}
	}

	allow = {
		if = {
			limit = { owner = { is_machine_empire = no } }
			can_build_gaiaseeder = yes
		}
		else = {
			can_build_gaiaseeder_machine = yes
		}
	}

	planet_modifier = {
		pop_environment_tolerance = 0.2
	}
}

building_gaiaseeders_4 = {
	base_buildtime = @b2_time
	category = government
	can_build = no
	can_demolish = no
	can_be_ruined = no
	can_be_disabled = no
	position_priority = 0

	destroy_trigger = {
		OR = {
			NOR = {
				is_planet_class = pc_gaia
				AND = {
					has_global_flag = planetarydiversity
					is_pd_gaia = yes
				}
			}
			NOT = { exists = owner }
			owner = {
				is_idyllic_bloom_empire = no
			}
		}
	}

	resources = {
		category = planet_buildings
		cost = {
			energy = 1500
			exotic_gases = @b4_rare_cost
		}
		upkeep = {
			energy = @b4_upkeep
			exotic_gases = @b3_rare_upkeep
			multiplier = value:gaiaseeder_cost_mult
		}
	}

	triggered_desc = {
		text = building_gaiaseeders_4_effect_desc
		trigger = {
			exists = planet
			planet = {
				NOR = {
					is_planet_class = pc_gaia
					AND = {
						has_global_flag = planetarydiversity
						is_pd_gaia = yes
					}
				}
			}
		}
	}

	triggered_desc = {
		text = gaia_seeder_bloomed_pops_effect
	}

	triggered_desc = {
		text = gaia_seeder_bloom_timer_tooltip
		trigger = {
			has_planet_flag = gaia_seeder_bloom_timer
		}
	}
}

building_gaiaseeders_pc_gaia = {
	base_buildtime = @b2_time
	base_cap_amount = 1
	category = government
	can_demolish = no
	can_be_ruined = no
	can_be_disabled = no
	position_priority = 0
	icon = building_gaiaseeders_4

	destroy_trigger = {
		OR = {
			NOT = {
				is_planet_class = pc_gaia
			}
			NOT = { exists = owner }
			owner = {
				is_idyllic_bloom_empire = no
			}
		}
	}

	resources = {
		category = planet_buildings
		cost = {
			energy = 1500
			exotic_gases = @b4_rare_cost
		}
		upkeep = {
			energy = @b4_upkeep
			exotic_gases = @b3_rare_upkeep
			multiplier = value:gaiaseeder_cost_mult
		}
	}

	potential = {
		hidden_trigger = {
			exists = owner
			owner = {
				OR = {
					is_country_type = default
					is_zofe_compatible = yes
				}
				is_idyllic_bloom_empire = yes
			}
			OR = {
				is_planet_class = pc_gaia
				AND = {
					has_global_flag = planetarydiversity
					is_pd_gaia = yes
				}
			}
			NOR = {
				has_building = building_gaiaseeders_4
				has_building_construction = building_gaiaseeders_4
				has_building = building_gaiaseeders_pc_gaia
				has_building_construction = building_gaiaseeders_pc_gaia
			}
		}
	}

	allow = {
		has_upgraded_capital = yes
		can_build_gaiaseeder = yes
	}

	triggered_desc = {
		text = building_gaiaseeders_4_effect_desc
		trigger = {
			exists = planet
			planet = {
				NOR = {
					is_planet_class = pc_gaia
					AND = {
						has_global_flag = planetarydiversity
						is_pd_gaia = yes
					}
				}
			}
		}
	}

	triggered_desc = {
		text = gaia_seeder_bloomed_pops_effect
	}

	triggered_desc = {
		text = gaia_seeder_bloom_timer_tooltip
		trigger = {
			has_planet_flag = gaia_seeder_bloom_timer
		}
	}
}

holding_idyllic_bloom = {
	base_buildtime = @b1_time
	owner_type = subject_holding
	icon = building_gaiaseeders_4
	base_cap_amount = 1

	category = government

	resources = {
		category = planet_holdings
		cost = {
			energy = 1500
			exotic_gases = @b4_rare_cost
		}
		upkeep = {
			trigger = {
				owner.overlord = { is_machine_empire = no }
			}
			energy = 20
			exotic_gases = @b3_rare_upkeep
			multiplier = value:overlord_gaiaseeder_upkeep
		}
		upkeep = {
			trigger = {
				owner.overlord = { is_machine_empire = yes }
			}
			energy = 20
			exotic_gases = @b3_rare_upkeep
			multiplier = value:overlord_gaiaseeder_upkeep_machine
		}
	}

	potential = {
		exists = owner
		owner.overlord = {
			OR = {
				is_country_type = default
				is_zofe_compatible = yes
			}
			is_idyllic_bloom_empire = yes
		}
		NOR = {
			is_planet_class = pc_gaia
			is_planet_class = pc_city
			is_planet_class = pc_hive
			is_planet_class = pc_machine
			is_planet_class = pc_relic
		}
		is_artificial = no
		if = {
			limit = { has_global_flag = planetarydiversity }
			is_pd_gaia = no
			is_pd_hive_world = no
			is_pd_machine = no
			is_pd_aquatics = no
			#is_artificial = no
			is_pd_habitat = no
			is_pd_unique = no
			is_pd_arcology = no
			is_pd_shroud_world = no
		}
	}

	planet_modifier = {
		pop_environment_tolerance = 0.2
	}

	triggered_planet_modifier = {
		potential = {
			exists = planet.owner
			planet.owner = {
				has_ascension_perk = ap_hydrocentric
			}
		}
		monthly_loyalty = -0.5
	}

	triggered_planet_modifier = {
		potential = {
			exists = planet.owner
			planet.owner = {
				NOT = { has_ascension_perk = ap_hydrocentric }
			}
		}
		monthly_loyalty = 1
	}

	on_built = {
		planet = {
			set_timed_planet_flag = {
				flag = anti_cheese_idyllic_bloom_flag
			days = 3599
			}
			set_saved_date = {
				key = idyllic_bloom_holding_timer
				days_from_present = 3600
				expires = 3600
			}
		}
		owner.overlord = {
			country_event = {
				id = plant.105
				days = 3600
			}
		}
	}
	on_destroy = {
		planet = {
			remove_planet_flag = anti_cheese_idyllic_bloom_flag
		}
	}
	triggered_desc = {
		trigger = {
			planet = {
				has_planet_flag = anti_cheese_idyllic_bloom_flag
			}
		}
		text = holding_idyllic_bloom_effect_timer
	}
	triggered_desc = {
		trigger = {
			planet = {
				NOT = {
					has_planet_flag = anti_cheese_idyllic_bloom_flag
				}
			}
		}
		text = holding_idyllic_bloom_effect
	}
	allow = {
		if = {
			limit = { owner.overlord = { is_machine_empire = no } }
			can_build_overlord_gaiaseeder = yes
		}
		else = {
			can_build_overlord_gaiaseeder_machine = yes
		}
	}
}

#############################################

# 00_capital_building
building_imperial_capital = {
	base_buildtime = @b4_time
	capital = yes
	can_build = no
	can_demolish = no
	can_be_ruined = no
	can_be_disabled = no
	position_priority = 0

	category = government

	potential = {
		exists = owner
		owner = {
			is_regular_empire = yes
			is_galactic_emperor = yes
		}
		planet = { is_capital = yes }
	}

	convert_to = {
		building_hive_major_capital
		building_machine_system_capital
		building_system_capital
		building_hab_system_capital
		building_ancient_control_center
		building_ancient_palace
	}

	allow = {
		OR = {
			PR_prmt_trgr_HC = { MORE = 50 }	# |PR转化|
			num_sapient_pops >= 50
		}
	}

	prerequisites = {
	}

	planet_modifier = {
		job_enforcer_add = 5
		planet_housing_add = 18
		planet_amenities_add = 18
		planet_max_buildings_add = 11
		planet_max_branch_office_buildings_add = 4
		defense_armies_add = @tier_4_capital_defense_armies
	}

	inline_script = {
		script = buildings/on_all_capital_buildings
	}

	inline_script = {
		script = buildings/regular_empire_capital_jobs
		PRIMARY_JOB = 3
		SECONDARY_JOB = 3
	}

	triggered_desc = {
		trigger = {
			has_planet_flag = habitat
		}
		text = building_hab_system_capital_tooltip
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_active_tradition = tr_domination_imperious_architecture
			}
		}
		modifier = {
			planet_housing_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_1 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.1
			planet_jobs_productive_produces_mult = 0.1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_2 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.1
			planet_jobs_productive_produces_mult = 0.1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_3 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.1
			planet_jobs_productive_produces_mult = 0.1
		}
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b4_minerals
		}
		upkeep = {
			energy = @b4_upkeep
		}
	}

	triggered_desc = {
		text = job_enforcer_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { has_valid_civic = civic_private_healthcare_corporate }
		}
		text = job_healthcare_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				is_pleasure_seeker = yes
			}
		}
		text = job_entertainer_effect_desc
	}
	    #莉莉修改
		triggered_planet_modifier = {
			potential = {
				exists = owner
				owner = {
					has_origin = origin_AL_Sierlint
				}
			}
			modifier = {
				job_AL_head_majyo_add = 2
			}
		}
		triggered_desc = {
			trigger = {
				exists = owner
				owner = {
					has_origin = origin_AL_Sierlint
				}
			}
			text = job_AL_head_majyo_effect_desc
		}
}

building_holo_theatres = {

	#	|PR转化|
	exempt_from_ai_planet_specialization = yes

	base_buildtime = @b1_time

	category = amenity

	potential = {
		NOT = {	has_modifier = slave_colony	}
		owner = {
			is_regular_empire = yes
			NOT = { has_valid_civic = civic_dystopian_society }
		}
		OR = {
			owner = {
				NOT = { is_ai = yes }
			}
			AND = {
				NOT = { has_available_jobs = entertainer }
				NOT = { has_forbidden_jobs = entertainer }
			}
		}
		NOT = { has_building = building_low_tech_capital }
	}

	destroy_trigger = {
		exists = owner
		OR = {
			owner = { is_regular_empire = no }
			owner = { has_valid_civic = civic_dystopian_society }
			has_modifier = slave_colony
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				NOT = { has_valid_civic = civic_warrior_culture }
			}
		}
		modifier = {
			job_entertainer_add = @b1_jobs
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_valid_civic = civic_warrior_culture
			}
		}
		modifier = {
			job_duelist_add = @b1_jobs
		}
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b1_minerals
		}
		upkeep = {
			energy = @b1_upkeep
		}
	}

	upgrades = {
		"building_hyper_entertainment_forum"
	}

	prerequisites = {
		"tech_holo_entertainment"
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				NOT = { has_valid_civic = civic_warrior_culture }
			}
		}
		text = job_entertainer_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_valid_civic = civic_warrior_culture
			}
		}
		text = job_duelist_effect_desc
	}
	    #莉莉修改
		triggered_planet_modifier = {
			potential = {
				exists = owner
				owner = {
					has_origin = origin_AL_kanba
				}
			}
			modifier = {
				job_entertainer_add = @b1_jobs
				job_duelist_add = @b1_jobs
			}
		}
}

building_hyper_entertainment_forum = {
	base_buildtime = @b2_time
	can_build = no

	category = amenity

	potential = {
		has_building = building_holo_theatres
	}

	allow = {
		has_upgraded_capital = yes
		owner = {
			NOT = { has_valid_civic = civic_dystopian_society }
		}
		OR = {
			owner = {
				NOT = { is_ai = yes }
			}
			AND = {
				NOT = { has_available_jobs = entertainer }
				NOT = { has_forbidden_jobs = entertainer }
			}
		}
	}

	destroy_trigger = {
		exists = owner
		owner = { has_valid_civic = civic_dystopian_society }
		OR = {
			owner = { is_regular_empire = no }
			has_modifier = slave_colony
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				NOT = { has_valid_civic = civic_warrior_culture }
			}
		}
		modifier = {
			job_entertainer_add = @b2_jobs
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_valid_civic = civic_warrior_culture
			}
		}
		modifier = {
			job_duelist_add = @b2_jobs
		}
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b2_minerals
			exotic_gases = @b2_rare_cost
		}
		upkeep = {
			energy = @b2_upkeep
			exotic_gases = @b2_rare_upkeep
		}
	}

	prerequisites = {
		"tech_hyper_entertainment_forum"
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				NOT = { has_valid_civic = civic_warrior_culture }
			}
		}
		text = job_entertainer_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_valid_civic = civic_warrior_culture
			}
		}
		text = job_duelist_effect_desc
	}
	    #莉莉修改
		triggered_planet_modifier = {
			potential = {
				exists = owner
				owner = {
					has_origin = origin_AL_kanba
				}
			}
			modifier = {
				job_entertainer_add = @b2_jobs
				job_duelist_add = @b2_jobs
			}
		}
}


building_contained_ecosphere = {
	icon = building_contained_ecosphere
	empire_limit = 1
	can_build = yes
	can_demolish = yes
	position_priority = 1

	category = resource

	potential = {
		owner = { has_country_flag = azaryn_dead }
	}

	resources = {
		category = planet_buildings
		cost = { minerals = 500 alloys = 500 }
		upkeep = { energy = 5 }
		produces = { food = 40 }
	}

	triggered_planet_modifier = {
		potential = {
			exists = planet.owner
			planet.owner = {
				is_machine_empire = no
				is_synthetic_empire = no
			}
		}
		pop_citizen_happiness = 0.1
		pop_growth_speed = 0.1
		planet_jobs_productive_produces_mult = 0.1
		planet_jobs_worker_produces_mult = 0.1
		planet_researchers_produces_mult = 0.1
	}

	triggered_planet_modifier = {
		potential = {
			exists = planet.owner
			planet.owner = {
				OR = {
					is_machine_empire = yes
					is_synthetic_empire = yes
				}
			}
		}
		pop_citizen_happiness = 0.2
		pop_growth_speed = 0.2
		planet_jobs_organics_produces_mult = 0.2
	}
	triggered_country_modifier = {
		potential = {
			exists = planet.owner
			planet.owner = {
				OR = {
					is_machine_empire = yes
					is_synthetic_empire = yes
				}
			}
		}
		country_society_tech_research_speed = 0.15
	}

	on_built = {
		planet = { add_modifier = { modifier = contained_ecosphere_pheromones } }
	}

	on_destroy = {
		planet = { remove_modifier = contained_ecosphere_pheromones }
	}
}

# 00_government_building
#警署
building_precinct_house = {
	#	|PR转化|
	exempt_from_ai_planet_specialization = yes

	base_buildtime = @b1_time

	category = government

	potential = {
		owner = { 
			is_regular_empire = yes 
			NOT = {
                has_origin = origin_AL_sagamihara
            }
		}
		NOT = { has_modifier = slave_colony }
	}

	allow = {
		hidden_trigger = {
			OR = {
				owner = { is_ai = no }
				AND = {
					NOT = { has_forbidden_jobs = enforcer }
					NOT = { has_available_jobs = enforcer }
				}
			}
		}
	}

	destroy_trigger = {
		exists = owner
		OR = {
			NOT = {	owner = { is_regular_empire = yes }	}
			AND = {
				owner = { is_ai = yes } #Players dont like random buildings blowing up
				planet = { has_building = building_hall_judgment }
			}#This way the AI gets to reclaim its building slots that it sunk into this expense
		}
	}

	planet_modifier = {
		job_enforcer_add = 2
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b1_minerals
		}
		upkeep = {
			energy = 2
		}
	}

	prerequisites = {
		"tech_planetary_government"
	}

	triggered_desc = {
		text = job_enforcer_effect_desc
	}

	show_tech_unlock_if = {
		is_regular_empire = yes
	}

	upgrades = {
		building_hall_judgment
	}
}

#############
# Science buildings
#############
# 05_research_building
building_research_lab_1 = {
	#	|PR转化|
	convert_to = {
		PR_building_TECH_lab_1
	}

	base_buildtime = @b1_time
	exempt_from_ai_planet_specialization = no
	category = research
	potential = {
		NOR = {
			has_planet_flag = PR_flg_plnt_VALID	# |PR转化|
			has_modifier = resort_colony
			has_modifier = slave_colony
			owner = {
				has_origin = origin_AL_Sierlint
			}
		}
	}
	destroy_trigger = {
		OR = {
			has_planet_flag = PR_flg_plnt_VALID	# |PR转化|
			has_modifier = resort_colony
			has_modifier = slave_colony
			owner = {
				has_origin = origin_AL_Sierlint
			}
		}
	}
	inline_script = {
		script = jobs/researchers_add
		AMOUNT = @b1_jobs
	}
	resources = {
		category = planet_buildings
		cost = {
			minerals = @b1_minerals
		}
		upkeep = {
			energy = @b1_upkeep
		}
	}
	upgrades = {
		"building_research_lab_2"
	}
	prerequisites = {
		"tech_basic_science_lab_1"
	}
}

#####################################
