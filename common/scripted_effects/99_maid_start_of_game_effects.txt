generate_machine_maid_start_buildings_and_districts = {
	if = {
		limit = {
			owner = { NOT = { has_origin = origin_shattered_ring } }
		}

		add_district_and_planet_size_if_needed_effect = { district = district_nexus }
		add_district_and_planet_size_if_needed_effect = { district = district_nexus }
		add_district_and_planet_size_if_needed_effect = { district = district_nexus }

		add_district_and_planet_size_if_needed_effect = { district = district_industrial }		# 2
		if = { limit = { owner = { has_origin = origin_default } }
			add_district_and_planet_size_if_needed_effect = { district = district_industrial }	# 2 (繁荣一统)
		}

		add_district_and_planet_size_if_needed_effect = { district = district_generator }		# 2
		add_district_and_planet_size_if_needed_effect = { district = district_generator }		# 2
		add_district_and_planet_size_if_needed_effect = { district = district_generator }		# 2

		add_district_and_planet_size_if_needed_effect = { district = district_mining }			# 2
		add_district_and_planet_size_if_needed_effect = { district = district_mining }			# 2
		if = { limit = { owner = { has_origin = origin_default } }
			add_district_and_planet_size_if_needed_effect = { district = district_mining }		# 2 (繁荣一统)
		}

		if = {
			limit = { last_created_species = { is_lithoid = no } }	#有机陈设种族
			add_district_and_planet_size_if_needed_effect = { district = district_farming }		# 2
		}																						#↑二选
		else = {																				#↓其一
			add_district_and_planet_size_if_needed_effect = { district = district_mining }		# 2
		}

		if = {
			limit = { owner = { is_catalytic_empire = yes } }
			remove_district = district_mining
			add_district_and_planet_size_if_needed_effect = { district = district_farming }
		}

		add_building = building_machine_capital			# 3
		add_building = building_machine_assembly_plant	# 1
		add_building = building_research_lab_1			# 2
		add_building = building_research_lab_1			# 2
		add_building = building_organic_sanctuary		# 2
		
		if = { #探险协议-4岗位：2电2矿
			limit = { owner = { has_valid_civic = civic_machine_exploration_protocol } }
			remove_district = district_generator
			remove_district = district_mining
		}
	}

	if = {
		limit = {
			owner = { has_origin = origin_shattered_ring }
		}

		add_deposit = d_segment_rubble_1
		add_deposit = d_segment_rubble_2
		add_deposit = d_segment_rubble_3
		add_deposit = d_segment_rubble_4
		add_deposit = d_decrepit_tunnels_1
		add_deposit = d_decrepit_tunnels_2
		add_deposit = d_decrepit_tunnels_3

		add_deposit = d_collapsed_burrows

		add_district_and_planet_size_if_needed_effect = { district = district_nexus }
		add_district_and_planet_size_if_needed_effect = { district = district_nexus }
		add_district_and_planet_size_if_needed_effect = { district = district_nexus }
		
		add_district_and_planet_size_if_needed_effect = { district = district_generator_uncapped }		# 2
		add_district_and_planet_size_if_needed_effect = { district = district_generator_uncapped }		# 2
		add_district_and_planet_size_if_needed_effect = { district = district_generator_uncapped }		# 2

		add_district_and_planet_size_if_needed_effect = { district = district_mining_uncapped }			# 2
		add_district_and_planet_size_if_needed_effect = { district = district_mining_uncapped }			# 2
		add_district_and_planet_size_if_needed_effect = { district = district_mining_uncapped }			# 2

		if = {
			limit = { last_created_species = { is_lithoid = no } }	#有机陈设种族
			add_district_and_planet_size_if_needed_effect = { district = district_farming_uncapped }	# 2
		}																								#↑二选
		else = {																						#↓其一
			add_district_and_planet_size_if_needed_effect = { district = district_mining_uncapped }		# 2
		}
		
		add_building = building_machine_capital			# 3
		add_building = building_machine_assembly_plant	# 1
		add_building = building_research_lab_1			# 2
		add_building = building_research_lab_1			# 2
		add_building = building_organic_sanctuary		# 2
		
		if = { #探险协议-4岗位：2电2矿
			limit = { owner = { has_valid_civic = civic_machine_exploration_protocol } }
			remove_district = district_generator_uncapped
			remove_district = district_mining_uncapped
		}
	}

	if = {
		limit = {
			owner = {
				has_origin = origin_remnants
				has_ancrel = yes
			}
		}
		owner = {
			give_technology = {
				tech = tech_archaeostudies
				message = no
			}
		}
		remove_building = building_research_lab_1
		add_building = building_archaeostudies_faculty
	}
	
	# Additional resources based on empire type and possible subspecies
	owner = {
		give_starting_resources_effect = yes
		add_resource = { consumer_goods = 100 }
	}
}

generate_machine_maid_start_pops_and_others = {
	if = {
		limit = { last_created_species = { has_trait = trait_noxious } }
		modify_species = {
			species = last_created_species
			remove_trait = trait_noxious
		}
	}
	
	# 基础 女仆13 机器10 手办10
	# 探险 女仆10 机器7  手办6
	last_created_species = {
		save_event_target_as = last_created_species
		set_species_flag = original_organic_species_of_@root.owner
		if = {
			limit = { has_trait = trait_noxious }
			modify_species = {
				species = THIS
				remove_trait = trait_noxious
			}
		}
		set_citizenship_type = {
			country = root.owner
			type = citizenship_organic_trophy
		}
		set_living_standard = {
			country = root.owner
			type = living_standard_organic_trophy
		}
	}
	if = { #探险协议-4手办
		limit = {
			owner = { has_valid_civic = civic_machine_exploration_protocol }
		}
		while = {
			count = 6
			create_pop = {
				species = last_created_species
				ethos = random
			}
			last_created_pop = {
				clear_ethos = yes
			}
		}
	}
	else = {
		while = {
			count = 10
			create_pop = {
				species = last_created_species
				ethos = random
			}
			last_created_pop = {
				clear_ethos = yes
			}
		}
	}
	if = {
		limit = {
			owner = { has_origin = origin_default }
		}
		while = {
			count = 2
			create_pop = {
				species = last_created_species
				ethos = random
			}
			last_created_pop = {
				clear_ethos = yes
			}
		}
	}
	if = {
		limit = {
			owner_main_species = {
				is_species_class = LBM
			}
		}
		owner = { 
			create_species = {
				name = "maid's_working_bot"
				plural = "maid's_working_bot"
				class = LBM
				namelist = this
				portrait = "LustMachine"
				traits = {
					trait = "trait_DC_ethic_lust_skynet"
					trait = "trait_machine_desire_body"
					trait = "trait_working_machine"
					trait = "trait_lv_custom_dildo_attachment"
					trait = "trait_lv_synth_breasts"
				}
			}
			set_built_species = owner_main_species
		}
	}
	else = {
		owner = { 
			create_species = {
				name = "maid's_working_bot"
				plural = "maid's_working_bot"
				class = MACHINE
				namelist = this
				portrait = "default_robot"
				traits = {
					trait = "trait_machine_unit"
					trait = "trait_working_machine"
				}
			}
			set_built_species = owner_main_species
		}
	}
	if = { #探险协议-3工作机器
		limit = {
			owner = { has_valid_civic = civic_machine_exploration_protocol }
		}
		while = {
			count = 7
			create_pop = {
				species = last_created_species
			}
		}
	}
	else = {
		while = {
			count = 10
			create_pop = {
				species = last_created_species
			}
		}
	}
	
	if = { #探险协议-3主物种
		limit = {
			owner = { has_valid_civic = civic_machine_exploration_protocol }
		}
		while = {
			limit = { num_pops < 23 }
			create_pop = {
				species = owner_main_species
			}
		}
	}
	else = {
		while = {
			limit = { num_pops < 33 }
			create_pop = {
				species = owner_main_species
			}
		}
	}
	if = {
		limit = {
			owner = { has_origin = origin_default }
		}
		while = {
			count = 4
			create_pop = {
				species = owner_main_species
			}
		}
	}
}