namespace = country_modifer

#开局联邦
country_event = {
	id = country_modifer.10
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		capital_scope = {
			solar_system = {
				closest_system = {
					limit = { has_owner = no }
					set_star_flag = fed_origin_system_1
					if = {
						limit = {
							any_system_planet = { habitable_planet = yes }
						}
						random_system_planet = {
							limit = { habitable_planet = yes }
							save_event_target_as = fed_planet_1
							set_planet_size = 16
						}
					}
					else = {
						random_system_planet = {
							limit = {
								is_ringworld = no
								is_asteroid = no
								is_star = no
								is_moon = no
							}
							save_event_target_as = fed_planet_1
							federation_origin_planet_setup = yes
						}
					}
				}
				closest_system = {
					limit = {
						NOT = { has_star_flag = fed_origin_system_1 }
						has_owner = no
						any_system_planet = {
							is_ringworld = no
							is_asteroid = no
							is_star = no
							is_moon = no
						}
					}
					if = {
						limit = {
							any_system_planet = { habitable_planet = yes }
						}
						random_system_planet = {
							limit = { habitable_planet = yes }
							save_event_target_as = fed_planet_2
							set_planet_size = 16
						}
					}
					else = {
						random_system_planet = {
							limit = {
								is_ringworld = no
								is_asteroid = no
								is_star = no
								is_moon = no
							}
							save_event_target_as = fed_planet_2
							federation_origin_planet_setup = yes
						}
					}
				}
			}
		}
		# First Member
		event_target:fed_planet_1 = {
			solar_system = {
				generate_home_system_resources = yes
			}
			if = {
				limit = {
					root = {
						has_valid_civic = civic_appease_regulations
					}
				}
				create_species = {
					name = "Magical_Girl"
					class = Magical_Girl
					portrait = "ELF"
					traits = {
						trait = trait_DC_ethic_asceticism
						trait = trait_beautiful
						trait = trait_extremely_intelligent
						trait = trait_virtuous
						trait = trait_forbidden_lust
						trait = trait_frigid
						trait = trait_highbrow
						trait = trait_inner_peace
					}
					homeworld = this
					effect = {
						save_event_target_as = fed_planet_1_species
					}
				}
			}
			else_if = {
				limit = {
					root = {
						has_valid_civic = civic_platonic_love
					}
				}
				create_species = {
					name = "Magical_Bitch"
					class = Magical_Bitch
					portrait = "COLDSUC"
					traits = {
						trait = trait_DC_ethic_carnalism
						trait = trait_coquettish
						trait = trait_ephemeral
						trait = trait_forever_naughty
						trait = trait_like_nudity
						trait = trait_soul_flesh_link
						trait = trait_animal_partner
						trait = trait_obscenity_remain
						trait = trait_sex_addiction
					}
					homeworld = this
					effect = {
						save_event_target_as = fed_planet_1_species
					}
				}
			}
			create_common_ground_member = { 
				NUM = 1 
			}
			create_colony = {
				owner = event_target:fed_member_1
			}
			generate_start_deposits_and_blockers = yes
			generate_start_buildings_and_districts = yes
			generate_start_pops = yes
			event_target:fed_member_1 = {
				give_starting_resources_effect = yes
			}
			solar_system = {
				create_starbase = {
					size = starbase_starport
					module = shipyard
					building = crew_quarters
					owner = event_target:fed_member_1
					effect = {
						set_starbase_module = {
							slot = 1
							module = trading_hub
						}
						set_starbase_module = {
							slot = 2
							module = shipyard
						}
					}
				}
			}
		}
		# Second Member
		event_target:fed_planet_2 = {
			solar_system = {
				generate_home_system_resources = yes
			}
			if = {
				limit = {
					root = {
						owner_main_species = {
							OR = {
								is_species_class = Magical_Bitch
								is_species_class = Magical_Girl
							}
						}
					}
				}
				create_species = {
					name = random
					class = random_non_machine
					portrait = random
					traits = random
					homeworld = this
					effect = {
						save_event_target_as = fed_planet_2_species
					}
				}
			}
			else = {
				if = {
					limit = {
						root = {
							has_valid_civic = civic_platonic_love
						}
					}
					create_species = {
						name = "Magical_Girl"
						class = Magical_Girl
						portrait = "ELF"
						traits = {
							trait = trait_DC_ethic_asceticism
							trait = trait_beautiful
							trait = trait_extremely_intelligent
							trait = trait_virtuous
							trait = trait_forbidden_lust
							trait = trait_frigid
							trait = trait_highbrow
							trait = trait_inner_peace
						}
						homeworld = this
						effect = {
							save_event_target_as = fed_planet_2_species
						}
					}
				}
				else_if = {
					limit = {
						root = {
							has_valid_civic = civic_appease_regulations
						}
					}
					create_species = {
						name = "Magical_Bitch"
						class = Magical_Bitch
						portrait = "COLDSUC"
						traits = {
							trait = trait_DC_ethic_carnalism
							trait = trait_coquettish
							trait = trait_ephemeral
							trait = trait_forever_naughty
							trait = trait_like_nudity
							trait = trait_soul_flesh_link
							trait = trait_animal_partner
							trait = trait_obscenity_remain
							trait = trait_sex_addiction
						}
						homeworld = this
						effect = {
							save_event_target_as = fed_planet_2_species
						}
					}
				}
			}
			create_common_ground_member = { 
				NUM = 2 
			}
			create_colony = { 
				owner = event_target:fed_member_2 
			}
			generate_start_deposits_and_blockers = yes
			generate_start_buildings_and_districts = yes
			generate_start_pops = yes
			event_target:fed_member_2 = {
				give_starting_resources_effect = yes
			}
			solar_system = {
				create_starbase = {
					size = starbase_starport
					module = shipyard
					building = crew_quarters
					owner = event_target:fed_member_2
					effect = {
						set_starbase_module = {
							slot = 1
							module = trading_hub
						}
						set_starbase_module = {
							slot = 2
							module = shipyard
						}
					}
				}
			}
		}
		event_target:fed_member_1 = {
			create_starting_leaders = yes
			country_event = {
				id = game_start.9
			}
			country_event = {
				id = game_start.33
				days = 1
			}
			# needs delay for system ownership to settle
			if = {
				limit = {
					is_species_class = Magical_Bitch
				}
				set_country_flag = carnalism_flag
			}
			else = {
				set_country_flag = asceticism_flag
			}
			join_alliance = {
				who = root
				override_requirements = yes
			}
			set_name = random			# Fixes some naming issues
		}
		event_target:fed_member_2 = {
			create_starting_leaders = yes
			country_event = {
				id = game_start.9
			}
			country_event = {
				id = game_start.33
				days = 1
			}
			if = {
				limit = {
					is_species_class = Magical_Bitch
				}
				set_country_flag = carnalism_flag
			}
			else_if = {
				limit = {
					is_species_class = Magical_Girl
				}
				set_country_flag = asceticism_flag
			}
			# needs delay for system ownership to settle
			join_alliance = {
				who = root
				override_requirements = yes
			}
			set_name = random			# Fixes some naming issues
		}
		federation = {
			set_federation_type = colorful_federation
			set_name = NAME_Colorful_Galaxy
			set_federation_law = succession_term_years_20
		}
		event_target:fed_member_1 = {
			add_opinion_modifier = {
				who = root
				modifier = opinion_common_ground
			}
			add_trust = {
				amount = 200
				who = root
			}
			add_trust = {
				amount = 200
				who = event_target:fed_member_2
			}
			add_intel = {
				amount = 60
				who = root
			}
			add_intel = {
				amount = 60
				who = event_target:fed_member_2
			}
		}
		event_target:fed_member_2 = {
			add_opinion_modifier = {
				who = root
				modifier = opinion_common_ground
			}
			add_trust = {
				amount = 200
				who = root
			}
			add_trust = {
				amount = 200
				who = event_target:fed_member_1
			}
			add_intel = {
				amount = 60
				who = root
			}
			add_intel = {
				amount = 60
				who = event_target:fed_member_1
			}
		}
		add_opinion_modifier = {
			who = event_target:fed_member_1
			modifier = opinion_common_ground
		}
		add_opinion_modifier = {
			who = event_target:fed_member_2
			modifier = opinion_common_ground
		}
		add_trust = {
			amount = 200
			who = event_target:fed_member_1
		}
		add_trust = {
			amount = 200
			who = event_target:fed_member_2
		}
		add_intel = {
			amount = 60
			who = event_target:fed_member_1
		}
		add_intel = {
			amount = 60
			who = event_target:fed_member_2
		}
		set_federation_leader = root
		if = {
			limit = {
				is_ai = no
				count_playable_country = { 
					limit = { 
						is_ai = no 
					} 
					count > 1 
				}
			}
			save_event_target_as = dc_fed_leader
			every_playable_country = {
				limit = {
					is_ai = no
					NOT = {
						is_same_empire = root
					}
				}
				country_event = {
					id = country_modifer.11
					days = 1
					random = 5
				}
			}
		}
	}
}